<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigator - Memory Image Explorer</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg
    viewBox='0 0 48 48' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='24'
    cy='24' r='22' fill='%236366f1'/%3E%3Cline x1='24' y1='14' x2='16' y2='24'
    stroke='%23fbbf24' stroke-width='2' stroke-linecap='round'/%3E%3Cline
    x1='24' y1='14' x2='32' y2='24' stroke='%23fbbf24' stroke-width='2'
    stroke-linecap='round'/%3E%3Cline x1='16' y1='24' x2='24' y2='34'
    stroke='%2310b981' stroke-width='2' stroke-linecap='round'/%3E%3Cline
    x1='32' y1='24' x2='24' y2='34' stroke='%2310b981' stroke-width='2'
    stroke-linecap='round'/%3E%3Cline x1='16' y1='24' x2='32' y2='24'
    stroke='%23ec4899' stroke-width='2' stroke-linecap='round'/%3E%3Ccircle
    cx='24' cy='14' r='4' fill='%23fef3c7'/%3E%3Ccircle cx='16' cy='24' r='4'
    fill='%23fde68a'/%3E%3Ccircle cx='32' cy='24' r='4'
    fill='%23fde68a'/%3E%3Ccircle cx='24' cy='34' r='4'
    fill='%23fef3c7'/%3E%3Ccircle cx='24' cy='24' r='3'
    fill='%23ffffff'/%3E%3Ctext x='24' y='43' font-family='Arial, sans-serif'
    font-size='5.5' font-weight='bold' fill='%23ffffff' text-anchor='middle'
    letter-spacing='1.5'%3ENavigator%3C/text%3E%3C/svg%3E">
    <style rel="stylesheet">:root,[data-theme=dark]{--bg-primary: #1e1e1e;--bg-secondary: #252526;--bg-tertiary: #2d2d30;--bg-hover: #2a2d2e;--bg-active: #094771;--bg-input: #1e1e1e;--border-primary: #3e3e42;--border-hover: #555;--text-primary: #d4d4d4;--text-secondary: #cccccc;--text-muted: #858585;--text-disabled: #666;--accent-primary: #0e639c;--accent-hover: #1177bb;--accent-active: #0d5a8f;--error-bg: #5a1d1d;--error-text: #f48771;--error-border: #f48771;--success-text: #89d185;--code-property: #9cdcfe;--code-value: #ce9178;--code-type: #4ec9b0;--scrollbar-track: #1e1e1e;--scrollbar-thumb: #424242;--scrollbar-thumb-hover: #4e4e4e;--shadow-color: rgba(0, 0, 0, .3);--overlay-bg: rgba(0, 0, 0, .7)}[data-theme=light]{--bg-primary: #ffffff;--bg-secondary: #f3f3f3;--bg-tertiary: #e8e8e8;--bg-hover: #e0e0e0;--bg-active: #0078d4;--bg-input: #ffffff;--border-primary: #d4d4d4;--border-hover: #a0a0a0;--text-primary: #333333;--text-secondary: #1e1e1e;--text-muted: #666666;--text-disabled: #a0a0a0;--accent-primary: #0078d4;--accent-hover: #106ebe;--accent-active: #005a9e;--error-bg: #fde7e9;--error-text: #d13438;--error-border: #d13438;--success-text: #107c10;--code-property: #0070c1;--code-value: #a31515;--code-type: #008080;--scrollbar-track: #f3f3f3;--scrollbar-thumb: #c0c0c0;--scrollbar-thumb-hover: #a8a8a8;--shadow-color: rgba(0, 0, 0, .15);--overlay-bg: rgba(0, 0, 0, .4)}*{box-sizing:border-box;margin:0;padding:0}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;height:100vh;display:flex;flex-direction:column;background:var(--bg-primary);color:var(--text-primary);overflow:hidden}#app{display:flex;flex-direction:column;height:100vh}.app-title{background:var(--bg-tertiary);color:var(--text-secondary);text-align:center;padding:8px 16px;font-size:14px;font-weight:600;letter-spacing:.5px;border-bottom:1px solid var(--border-primary);flex-shrink:0}header{background:var(--bg-secondary);border-bottom:1px solid var(--border-primary);flex-shrink:0}.compact-header{display:flex;align-items:center;justify-content:space-between;background:var(--bg-secondary);border-bottom:1px solid var(--border-primary);padding:6px 12px;gap:16px;flex-shrink:0;min-height:40px}.header-left{display:flex;align-items:center;gap:10px;flex-shrink:1;min-width:0}.header-left svg{flex-shrink:0}.app-title-inline{font-size:14px;font-weight:600;color:var(--text-secondary);white-space:nowrap;flex-shrink:0}.title-separator{color:var(--text-muted);font-size:14px;flex-shrink:0}.memimg-name-inline{font-size:14px;font-weight:600;color:var(--text-primary);margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0}.header-right{display:flex;align-items:center;gap:6px;flex-shrink:0}.compact-btn{padding:4px 8px;font-size:12px;min-width:unset}.logo{display:flex;align-items:center;gap:12px;padding:10px 16px}.logo img{width:32px;height:32px}.logo h1{font-size:20px;font-weight:600;color:var(--text-secondary);margin:0}.logo .subtitle{font-size:12px;color:var(--text-muted);font-weight:400}.controls{display:flex;gap:8px;padding:8px 16px;align-items:center;border-top:1px solid var(--border-primary);justify-content:space-between}.controls-left,.controls-right{display:flex;gap:8px;align-items:center}.status-bar{padding:6px 16px;font-size:12px;color:var(--text-muted);border-top:1px solid var(--border-primary);min-height:28px}.status-bar.error{color:var(--error-text);background:var(--error-bg)}.status-bar.success{color:var(--success-text)}.dirty-indicator{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;margin-right:4px;background:var(--error-bg);border:1px solid var(--error-border);border-radius:3px;color:var(--error-text);font-size:11px;font-weight:600;letter-spacing:.5px;animation:pulse 2s ease-in-out infinite}@keyframes pulse{0%,to{box-shadow:0 0 #f48771b3}50%{box-shadow:0 0 0 3px #f4877100}}#save-btn.dirty{animation:save-pulse 3s ease-in-out infinite}@keyframes save-pulse{0%,to{background:var(--accent-primary);box-shadow:0 0 #f48771b3}50%{background:#c75146;box-shadow:0 0 0 4px #f4877100}}#save-btn.dirty:hover{background:#d66058;animation:none}button{background:var(--accent-primary);color:#fff;border:none;padding:6px 14px;border-radius:2px;cursor:pointer;font-size:13px;transition:background .2s}button:hover{background:var(--accent-hover)}button:active{background:var(--accent-active)}button:disabled{background:var(--border-hover);cursor:not-allowed;opacity:.5}#bottom-panels{flex:1;display:flex;flex-direction:row;overflow:hidden;min-height:50px}.panel{display:flex;flex-direction:column;overflow:hidden}#tree-panel{flex:1;border-right:1px solid var(--border-primary)}#inspector-panel{flex:1}.panel-header{background:var(--bg-tertiary);padding:10px 16px;font-size:13px;font-weight:600;color:var(--text-secondary);border-bottom:1px solid var(--border-primary);display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.panel-header h2{font-size:13px;font-weight:600;margin:0}.nav-buttons{display:flex;gap:4px}.nav-buttons button{background:var(--border-primary);color:var(--text-secondary);border:none;padding:4px 10px;border-radius:2px;cursor:pointer;font-size:12px;transition:background .2s;min-width:32px}.nav-buttons button:hover:not(:disabled){background:var(--border-hover)}.nav-buttons button:active:not(:disabled){background:var(--bg-tertiary)}.nav-buttons button:disabled{background:var(--bg-tertiary);color:var(--text-disabled);cursor:not-allowed;opacity:.5}.panel-content{flex:1;overflow:auto;padding:12px;background:var(--bg-primary)}.path-display{font-size:11px;color:var(--text-muted);font-family:Consolas,Monaco,monospace}.tree-node{-webkit-user-select:none;user-select:none;margin:2px 0}.tree-node-header{display:flex;align-items:center;padding:3px 6px;cursor:pointer;border-radius:3px}.tree-node-header:hover{background:var(--bg-hover)}.tree-node-header.selected{background:var(--bg-active)}.tree-toggle{width:16px;height:16px;display:inline-flex;align-items:center;justify-content:center;font-size:10px;margin-right:4px;color:var(--text-secondary);flex-shrink:0}.tree-toggle.collapsed:before{content:"▶"}.tree-toggle.expanded:before{content:"▼"}.tree-toggle.leaf{visibility:hidden}.tree-icon{margin-right:6px;font-size:14px;flex-shrink:0}.tree-label{font-size:13px;color:var(--text-secondary)}.tree-children{margin-left:20px;display:none}.tree-children.expanded{display:block}.property-table{width:100%;border-collapse:collapse;font-size:13px}.property-table th{text-align:left;padding:10px 12px;background:var(--bg-tertiary);border-bottom:1px solid var(--border-primary);font-weight:600;color:var(--text-secondary)}.property-table td{padding:8px 12px;border-bottom:1px solid var(--border-primary);vertical-align:top}.property-name{color:var(--code-property);font-family:Consolas,Monaco,monospace}.property-value{color:var(--code-value);font-family:Consolas,Monaco,monospace;word-break:break-word}.property-value.clickable{cursor:pointer;text-decoration:underline}.property-value.clickable:hover{color:var(--code-value);opacity:.8}.property-type{color:var(--code-type);font-size:11px;font-style:italic;margin-left:8px}.empty-state{color:var(--text-muted);font-size:13px;padding:24px;text-align:center}#editor-panel{border-bottom:1px solid var(--border-primary);flex:1;min-height:50px;display:flex;flex-direction:column}.editor-wrapper{flex:1;display:flex;position:relative;overflow:hidden;background:var(--bg-primary);min-height:0}.line-numbers{background:var(--bg-primary);color:var(--text-muted);padding:16px 8px;text-align:right;font-family:Consolas,Monaco,Courier New,monospace;font-size:14px;line-height:1.5;-webkit-user-select:none;user-select:none;border-right:1px solid var(--border-primary);overflow-y:auto;overflow-x:hidden;white-space:pre;flex-shrink:0}.code-editor{flex:1;font-family:Consolas,Monaco,Courier New,monospace;font-size:14px;padding:16px;background:var(--bg-primary);color:var(--text-primary);border:none;outline:none;-moz-tab-size:2;tab-size:2;line-height:1.5;overflow-y:auto;overflow-x:auto;white-space:pre;overflow-wrap:normal}.code-editor>div{min-height:100%;outline:none}.code-editor .token.comment,.code-editor .token.prolog,.code-editor .token.doctype,.code-editor .token.cdata{color:#6a9955}.code-editor .token.punctuation{color:var(--text-primary)}.code-editor .token.property,.code-editor .token.tag,.code-editor .token.boolean,.code-editor .token.number,.code-editor .token.constant,.code-editor .token.symbol{color:#b5cea8}.code-editor .token.selector,.code-editor .token.attr-name,.code-editor .token.string,.code-editor .token.char,.code-editor .token.builtin{color:#ce9178}.code-editor .token.operator,.code-editor .token.entity,.code-editor .token.url,.code-editor .token.variable{color:var(--text-primary)}.code-editor .token.atrule,.code-editor .token.attr-value,.code-editor .token.keyword{color:#569cd6}.code-editor .token.function,.code-editor .token.class-name{color:#dcdcaa}.code-editor .token.regex,.code-editor .token.important{color:#d16969}.error-panel{background:var(--error-bg);border-top:2px solid var(--error-border);padding:12px 16px;font-family:Consolas,Monaco,Courier New,monospace;font-size:12px;color:var(--error-text);line-height:1.6;white-space:pre-wrap;word-wrap:break-word;max-height:120px;overflow-y:auto}::-webkit-scrollbar{width:12px;height:12px}::-webkit-scrollbar-track{background:var(--scrollbar-track)}::-webkit-scrollbar-thumb{background:var(--scrollbar-thumb);border-radius:6px}::-webkit-scrollbar-thumb:hover{background:var(--scrollbar-thumb-hover)}.view-container{display:flex;flex-direction:column;height:100vh;width:100%}#explorer-view{display:flex;flex-direction:column;overflow:hidden}.list-header{background:var(--bg-secondary);border-bottom:1px solid var(--border-primary);padding:16px 24px;flex-shrink:0}.list-header .logo{display:flex;align-items:center;gap:12px;margin-bottom:16px}.list-header .controls{display:flex;gap:8px;justify-content:flex-end}.list-content{flex:1;overflow-y:auto;padding:32px;background:var(--bg-primary)}.memimg-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:24px;max-width:1400px;margin:0 auto}.memimg-card{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:6px;padding:20px;cursor:pointer;transition:all .2s ease;display:flex;flex-direction:column;gap:12px}.memimg-card:hover{border-color:var(--accent-primary);transform:translateY(-2px);box-shadow:0 4px 12px var(--shadow-color)}.card-header{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}.card-title{font-size:18px;font-weight:600;color:var(--text-secondary);margin:0;flex:1;word-break:break-word}.card-actions{display:flex;gap:4px;flex-shrink:0}.icon-btn{background:transparent;border:1px solid var(--border-primary);padding:4px 8px;border-radius:3px;cursor:pointer;font-size:14px;transition:all .2s;min-width:unset}.icon-btn:hover{background:var(--border-primary);border-color:var(--border-hover)}.icon-btn:active{background:var(--bg-tertiary)}.card-body{flex:1;display:flex;flex-direction:column;gap:12px}.card-description{color:var(--text-muted);font-size:14px;line-height:1.5;margin:0;min-height:42px}.card-description em{opacity:.6}.card-meta{display:flex;flex-direction:column;gap:6px;font-size:12px;color:var(--text-disabled)}.meta-item{display:flex;align-items:center;gap:6px}.card-footer{display:flex;justify-content:flex-end;padding-top:12px;border-top:1px solid var(--border-primary)}.open-btn{background:var(--accent-primary);color:#fff;border:none;padding:8px 16px;border-radius:3px;cursor:pointer;font-size:14px;font-weight:600;transition:background .2s}.open-btn:hover{background:var(--accent-hover)}.empty-state{text-align:center;padding:80px 24px;color:var(--text-muted)}.empty-icon{font-size:64px;margin-bottom:24px}.empty-state h2{font-size:24px;color:var(--text-secondary);margin:0 0 12px}.empty-state p{font-size:16px;margin:0 0 24px}.primary-button{background:var(--accent-primary);color:#fff;border:none;padding:10px 20px;border-radius:3px;cursor:pointer;font-size:14px;font-weight:600;transition:background .2s}.primary-button:hover{background:var(--accent-hover)}.error-state{text-align:center;padding:80px 24px;color:var(--error-text)}.error-state h2{font-size:24px;margin:0 0 12px}.error-state p{font-size:16px;margin:0}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:var(--overlay-bg);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn .2s ease}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.modal-dialog{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:6px;width:90%;max-width:500px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;animation:slideIn .2s ease}@keyframes slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header{padding:20px 24px;border-bottom:1px solid var(--border-primary);display:flex;justify-content:space-between;align-items:center}.modal-header h2{font-size:18px;font-weight:600;color:var(--text-secondary);margin:0}.modal-close{background:transparent;border:none;color:var(--text-muted);font-size:28px;line-height:1;cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:3px;transition:all .2s}.modal-close:hover{background:var(--border-primary);color:var(--text-secondary)}.modal-body{padding:24px;overflow-y:auto;flex:1}.form-group{margin-bottom:20px}.form-group:last-child{margin-bottom:0}.form-group label{display:block;margin-bottom:8px;color:var(--text-secondary);font-size:14px;font-weight:600}.form-input,.form-textarea{width:100%;background:var(--bg-input);border:1px solid var(--border-primary);border-radius:3px;padding:10px 12px;color:var(--text-primary);font-size:14px;font-family:inherit;transition:border-color .2s}.form-input:focus,.form-textarea:focus{outline:none;border-color:var(--accent-primary)}.form-textarea{resize:vertical;font-family:inherit}.modal-footer{padding:16px 24px;border-top:1px solid var(--border-primary);display:flex;justify-content:flex-end;gap:12px}.cancel-btn{background:transparent;border:1px solid var(--border-primary);color:var(--text-secondary);padding:8px 16px;border-radius:3px;cursor:pointer;font-size:14px;transition:all .2s}.cancel-btn:hover{background:var(--border-primary);border-color:var(--border-hover)}.save-btn,.create-btn{background:var(--accent-primary);color:#fff;border:none;padding:8px 16px;border-radius:3px;cursor:pointer;font-size:14px;font-weight:600;transition:background .2s}.save-btn:hover,.create-btn:hover{background:var(--accent-hover)}.header-info{display:flex;flex-direction:column;gap:8px}.back-button{background:transparent;border:1px solid var(--border-primary);color:var(--text-muted);padding:4px 12px;border-radius:3px;cursor:pointer;font-size:13px;align-self:flex-start;transition:all .2s}.back-button:hover{background:var(--border-primary);color:var(--text-secondary);border-color:var(--border-hover)}#current-memimg-name{font-size:16px;margin:0;color:var(--text-secondary)}.resize-handle{background:var(--border-primary);flex-shrink:0;position:relative;z-index:10;transition:background .2s}.resize-handle:hover{background:var(--accent-primary)}.resize-handle:active{background:var(--accent-hover)}.resize-handle-horizontal{height:4px;cursor:ns-resize;width:100%}.resize-handle-vertical{width:4px;cursor:ew-resize;height:100%}.sidebar{position:fixed;left:0;top:0;bottom:0;width:400px;background:var(--bg-secondary);border-right:1px solid var(--border-primary);transform:translate(0);transition:transform .3s ease;z-index:1000;display:flex;flex-direction:column;box-shadow:2px 0 8px var(--shadow-color)}.sidebar.collapsed{transform:translate(-400px)}.sidebar-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid var(--border-primary);background:var(--bg-tertiary)}.sidebar-header h3{font-size:15px;font-weight:600;color:var(--text-secondary);margin:0}.sidebar-controls{display:flex;gap:8px;padding:12px 16px;border-bottom:1px solid var(--border-primary);background:var(--bg-secondary)}#history-search{flex:1;background:var(--bg-primary);border:1px solid var(--border-primary);border-radius:3px;padding:6px 10px;color:var(--text-primary);font-size:13px;outline:none}#history-search:focus{border-color:var(--accent-primary)}.sidebar-stats{padding:8px 16px;font-size:11px;color:var(--text-muted);border-bottom:1px solid var(--border-primary);background:var(--bg-secondary)}.sidebar-content{flex:1;overflow-y:auto;background:var(--bg-primary)}.history-entry{padding:12px 16px;border-bottom:1px solid var(--border-primary);transition:background .2s}.history-entry:hover{background:var(--bg-hover)}.history-entry-header{display:flex;align-items:center;gap:8px;margin-bottom:8px}.history-status{color:var(--success-text);font-size:8px;line-height:1}.history-timestamp{font-size:11px;color:var(--text-muted);flex:1}.history-size{font-size:11px;color:var(--text-disabled)}.history-code{margin-bottom:8px}.history-code pre{font-family:Consolas,Monaco,monospace;font-size:12px;color:var(--text-primary);background:var(--bg-primary);padding:8px 10px;border-radius:3px;border:1px solid var(--border-primary);margin:0;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;line-height:1.4}.history-code.expandable pre{cursor:pointer}.history-actions{display:flex;gap:6px;flex-wrap:wrap}.history-btn{background:transparent;border:1px solid var(--border-primary);color:var(--text-secondary);padding:4px 10px;border-radius:3px;cursor:pointer;font-size:11px;transition:all .2s;white-space:nowrap}.history-btn:hover{background:var(--border-primary);border-color:var(--border-hover)}.history-btn:active{background:var(--bg-tertiary)}.history-empty,.history-error{padding:40px 24px;text-align:center;color:var(--text-muted);font-size:13px}.history-error{color:var(--error-text)}.editor-controls{display:flex;gap:8px;align-items:center}#toggle-history-btn{background:transparent;border:1px solid var(--border-primary);color:var(--text-secondary);padding:6px 12px}#toggle-history-btn:hover{background:var(--border-primary);border-color:var(--border-hover)}#theme-toggle-list,#theme-toggle-explorer{min-width:36px;font-size:18px;padding:6px 10px}#toggle-line-numbers-btn{color:var(--text-secondary);font-weight:700;font-size:16px}.value-navigable{cursor:pointer}.value-navigable:hover{opacity:.8}.value-null,.value-undefined{color:var(--text-muted);font-style:italic}.value-string{color:var(--code-value)}.value-number{color:#b5cea8}.value-boolean{color:#569cd6}.value-bigint{color:#b5cea8}.value-symbol{color:#ce9178}.value-date{color:#4fc1ff}.value-function,.value-array,.value-map,.value-set,.value-object{color:var(--code-type)}[data-theme=light] .value-number,[data-theme=light] .value-bigint{color:#098658}[data-theme=light] .value-boolean{color:#00f}[data-theme=light] .value-symbol{color:#a31515}[data-theme=light] .value-date{color:#0078d4}.inspector-tabs{display:flex;flex-direction:column;height:100%}.tab-headers{display:flex;border-bottom:1px solid var(--border-primary);background:var(--bg-secondary);flex-shrink:0}.tab-header{background:transparent;border:none;border-bottom:2px solid transparent;padding:10px 20px;cursor:pointer;font-size:13px;font-weight:500;color:var(--text-muted);transition:all .2s;position:relative}.tab-header:hover:not(:disabled){color:var(--text-secondary);background:var(--bg-hover)}.tab-header.active{color:var(--accent-primary);border-bottom-color:var(--accent-primary);font-weight:600}.tab-header:disabled{color:var(--text-disabled);cursor:not-allowed;opacity:.5}.tab-content{flex:1;overflow:auto;background:var(--bg-primary)}.tab-panel{display:none;padding:12px}.tab-panel.active{display:block}.collections-panel{display:flex;flex-direction:column;gap:16px}.collection-section{border:1px solid var(--border-primary);border-radius:4px;background:var(--bg-secondary);padding:12px}.collection-header{color:var(--code-property);font-family:Consolas,Monaco,monospace;font-size:14px;font-weight:600;margin:0 0 12px;padding-bottom:8px;border-bottom:1px solid var(--border-primary)}.collection-items{list-style:none;padding:0;margin:0}.collection-item{padding:6px 8px;border-radius:3px;font-family:Consolas,Monaco,monospace;font-size:13px;transition:background .2s}.collection-item:hover{background:var(--bg-hover)}.item-label{color:var(--text-muted);margin-right:4px}.item-value{color:var(--code-value)}.value-nested{color:var(--code-type);cursor:pointer;display:inline-flex;align-items:center;font-family:Consolas,Monaco,monospace}.value-nested-toggle{display:inline-block;width:14px;height:14px;margin-right:4px;font-size:10px;color:var(--text-muted)}.value-nested-toggle.collapsed:before{content:"▶"}.value-nested-toggle.expanded:before{content:"▼"}.value-nested-summary{color:var(--code-type);text-decoration:underline}.value-nested:hover .value-nested-summary{opacity:.8}.nested-properties{display:none;margin-top:8px;padding-left:24px;border-left:2px solid var(--border-primary)}.nested-properties.expanded{display:block}.nested-prop{padding:4px 0;font-size:12px}.nested-prop-key{color:var(--code-property);margin-right:6px}.nested-prop-value{color:var(--code-value)}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.property,.token.tag,.token.constant,.token.symbol,.token.deleted{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#a6e22e}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.function,.token.class-name{color:#e6db74}.token.keyword{color:#66d9ef}.token.regex,.token.important{color:#fd971f}.token.important,.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style>
    <!-- JavaScript Type System - Inlined for file:// protocol compatibility -->
    <script>
(function(global) {
  'use strict';

  function Type(name) {
    this.typeName = name;
  }

  Type.prototype.check = function(value) {
    throw new Error(`${this.typeName}.check() not implemented`);
  };

  function PrimitiveType(name) {
    Type.call(this, name);
  }

  PrimitiveType.prototype = Object.create(Type.prototype);
  PrimitiveType.prototype.constructor = PrimitiveType;

  PrimitiveType.prototype.check = function(value) {
    switch(this.typeName) {
      case 'number': return typeof value === 'number';
      case 'string': return typeof value === 'string';
      case 'boolean': return typeof value === 'boolean';
      case 'bigint': return typeof value === 'bigint';
      case 'symbol': return typeof value === 'symbol';
      case 'undefined': return value === undefined;
      case 'null': return value === null;
      default: return false;
    }
  };

  const NumberType = new PrimitiveType('number');
  const StringType = new PrimitiveType('string');
  const BooleanType = new PrimitiveType('boolean');
  const BigIntType = new PrimitiveType('bigint');
  const SymbolType = new PrimitiveType('symbol');
  const UndefinedType = new PrimitiveType('undefined');
  const NullType = new PrimitiveType('null');

  function ObjectType({name, properties = {}, prototype = null}) {
    const factory = function(props = {}) {
      const instance = Object.create(factory.prototype);

      Object.keys(properties).forEach(propName => {
        if (propName in props) {
          instance[propName] = props[propName];
        }
      });

      Object.defineProperty(instance, '__type__', {
        value: factory,
        writable: false,
        enumerable: false,
        configurable: false
      });

      return instance;
    };

    if (prototype) {
      factory.prototype = Object.create(prototype);
    } else {
      factory.prototype = {};
    }

    factory.typeName = name;
    factory.properties = properties;

    Object.setPrototypeOf(factory, ObjectType.prototype);
    Type.call(factory, name);

    return factory;
  }

  Type.call(ObjectType, 'ObjectType');
  ObjectType.prototype = Object.create(Type.prototype);
  ObjectType.prototype.constructor = ObjectType;

  ObjectType.prototype.check = function(value) {
    return typeof value === 'object' && value !== null && value.__type__ === this;
  };

  function FunctionType({name, signature = null}) {
    Type.call(this, name);
    this.signature = signature;
  }

  FunctionType.prototype = Object.create(Type.prototype);
  FunctionType.prototype.constructor = FunctionType;

  FunctionType.prototype.check = function(value) {
    return typeof value === 'function';
  };

  function ArrayType(elementType = null) {
    Type.call(this, elementType ? `Array<${elementType.typeName}>` : 'Array');
    this.elementType = elementType;
  }

  ArrayType.prototype = Object.create(Type.prototype);
  ArrayType.prototype.constructor = ArrayType;

  ArrayType.prototype.check = function(value) {
    return Array.isArray(value);
  };

  const ArrayTypeInstance = new ArrayType();

  function SetType(elementType = null) {
    Type.call(this, elementType ? `Set<${elementType.typeName}>` : 'Set');
    this.elementType = elementType;
  }

  SetType.prototype = Object.create(Type.prototype);
  SetType.prototype.constructor = SetType;

  SetType.prototype.check = function(value) {
    return value instanceof Set;
  };

  const SetTypeInstance = new SetType();

  function MapType(keyType = null, valueType = null) {
    const keyPart = keyType ? keyType.typeName : '*';
    const valuePart = valueType ? valueType.typeName : '*';
    Type.call(this, `Map<${keyPart}, ${valuePart}>`);
    this.keyType = keyType;
    this.valueType = valueType;
  }

  MapType.prototype = Object.create(Type.prototype);
  MapType.prototype.constructor = MapType;

  MapType.prototype.check = function(value) {
    return value instanceof Map;
  };

  const MapTypeInstance = new MapType();

  function DateType() {
    Type.call(this, 'Date');
  }

  DateType.prototype = Object.create(Type.prototype);
  DateType.prototype.constructor = DateType;

  DateType.prototype.check = function(value) {
    return value instanceof Date;
  };

  const DateTypeInstance = new DateType();

  const JSTypes = {
    Type,
    PrimitiveType,
    NumberType,
    StringType,
    BooleanType,
    BigIntType,
    SymbolType,
    UndefinedType,
    NullType,
    ObjectType,
    FunctionType,
    ArrayType,
    ArrayTypeInstance,
    SetType,
    SetTypeInstance,
    MapType,
    MapTypeInstance,
    DateType,
    DateTypeInstance
  };

  global.JSTypes = JSTypes;
  global.Type = Type;
  global.PrimitiveType = PrimitiveType;
  global.NumberType = NumberType;
  global.StringType = StringType;
  global.BooleanType = BooleanType;
  global.BigIntType = BigIntType;
  global.SymbolType = SymbolType;
  global.UndefinedType = UndefinedType;
  global.NullType = NullType;
  global.ObjectType = ObjectType;
  global.FunctionType = FunctionType;
  global.ArrayType = ArrayType;
  global.SetType = SetType;
  global.MapType = MapType;
  global.DateType = DateType;
  global.DateTypeInstance = DateTypeInstance;

})(typeof window !== 'undefined' ? window : global);
    </script>
  <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function Gt(e){return Array.isArray(e)||e instanceof Map||e instanceof Set}var W=(e=>(e[e.NULL=0]="NULL",e[e.UNDEFINED=1]="UNDEFINED",e[e.PRIMITIVE=2]="PRIMITIVE",e[e.BIGINT=3]="BIGINT",e[e.SYMBOL=4]="SYMBOL",e[e.DATE=5]="DATE",e[e.FUNCTION=6]="FUNCTION",e[e.ARRAY=7]="ARRAY",e[e.MAP=8]="MAP",e[e.SET=9]="SET",e[e.OBJECT=10]="OBJECT",e))(W||{});function Kt(e){if(e===null)return{category:0,isPrimitive:!0,isObject:!1,isCollection:!1,needsSpecialSerialization:!1};if(e===void 0)return{category:1,isPrimitive:!0,isObject:!1,isCollection:!1,needsSpecialSerialization:!1};const t=typeof e;return t==="string"||t==="number"||t==="boolean"?{category:2,isPrimitive:!0,isObject:!1,isCollection:!1,needsSpecialSerialization:!1}:t==="bigint"?{category:3,isPrimitive:!0,isObject:!1,isCollection:!1,needsSpecialSerialization:!0}:t==="symbol"?{category:4,isPrimitive:!0,isObject:!1,isCollection:!1,needsSpecialSerialization:!0}:e instanceof Date?{category:5,isPrimitive:!1,isObject:!0,isCollection:!1,needsSpecialSerialization:!0}:t==="function"?{category:6,isPrimitive:!1,isObject:!0,isCollection:!1,needsSpecialSerialization:!0}:Array.isArray(e)?{category:7,isPrimitive:!1,isObject:!0,isCollection:!0,needsSpecialSerialization:!1}:e instanceof Map?{category:8,isPrimitive:!1,isObject:!0,isCollection:!0,needsSpecialSerialization:!0}:e instanceof Set?{category:9,isPrimitive:!1,isObject:!0,isCollection:!0,needsSpecialSerialization:!0}:{category:10,isPrimitive:!1,isObject:!0,isCollection:!1,needsSpecialSerialization:!1}}const L={SET:"SET",DELETE:"DELETE",ARRAY_PUSH:"ARRAY_PUSH",ARRAY_POP:"ARRAY_POP",ARRAY_SHIFT:"ARRAY_SHIFT",ARRAY_UNSHIFT:"ARRAY_UNSHIFT",ARRAY_SPLICE:"ARRAY_SPLICE",ARRAY_SORT:"ARRAY_SORT",ARRAY_REVERSE:"ARRAY_REVERSE",ARRAY_FILL:"ARRAY_FILL",ARRAY_COPYWITHIN:"ARRAY_COPYWITHIN",MAP_SET:"MAP_SET",MAP_DELETE:"MAP_DELETE",MAP_CLEAR:"MAP_CLEAR",SET_ADD:"SET_ADD",SET_DELETE:"SET_DELETE",SET_CLEAR:"SET_CLEAR",SCRIPT:"SCRIPT"},ye={TYPE:"__type__",DATE_VALUE:"__dateValue__"};class Jt{constructor(){this.seen=new Map}hasSeen(t){return this.seen.has(t)}markSeen(t,n){this.seen.set(t,n)}getReference(t){return this.seen.has(t)?{__type__:"ref",path:this.seen.get(t)||[]}:null}}class Xt{constructor(t,n){this.targetToPath=t,this.currentPath=n,this.seen=new Map}hasSeen(t){return this.seen.has(t)}markSeen(t,n){this.seen.set(t,n)}getReference(t){const n=this.targetToPath.get(t);return n&&n.length>0&&!(n.length>=this.currentPath.length&&this.currentPath.every((s,a)=>s===n[a]))?{__type__:"ref",path:n}:this.hasSeen(t)?{__type__:"ref",path:this.seen.get(t).slice(this.currentPath.length)}:null}}function me(e,t,n,r){const s=typeof e=="object"&&e!==null&&r.get(e)||e,a=Kt(s);switch(a.category){case W.NULL:case W.UNDEFINED:return e;case W.PRIMITIVE:return e;case W.BIGINT:return{[ye.TYPE]:"bigint",value:e.toString()};case W.SYMBOL:return{[ye.TYPE]:"symbol",description:e.description};case W.DATE:{const o=r.get(e)||e,i=n.getReference(o);if(i)return i;n.markSeen(o,t);const c=o,d=c.getTime(),l=isNaN(d)?null:c.toISOString(),u={[ye.TYPE]:"date",[ye.DATE_VALUE]:l},m=Object.entries(c);for(const[y,v]of m)u[y]=me(v,[...t,y],n,r);return u}case W.FUNCTION:{const o=e;return o.__type__==="function"?{[ye.TYPE]:"function",sourceCode:o.sourceCode||e.toString()}:void 0}case W.MAP:case W.SET:case W.ARRAY:case W.OBJECT:{const o=r.get(e)||e,i=n.getReference(o);if(i)return i;if(n.markSeen(o,t),a.category===W.MAP)return{[ye.TYPE]:"map",entries:Array.from(o.entries()).map(([l,u],m)=>[me(l,[...t,"key",String(m)],n,r),me(u,[...t,"value",String(m)],n,r)])};if(a.category===W.SET)return{[ye.TYPE]:"set",values:Array.from(o.values()).map((l,u)=>me(l,[...t,String(u)],n,r))};if(a.category===W.ARRAY)return e.map((l,u)=>me(l,[...t,String(u)],n,r));const c={},d=e;for(const l in d)Object.prototype.hasOwnProperty.call(d,l)&&(c[l]=me(d[l],[...t,l],n,r));return c}default:return}}const xt=(e,t)=>{const n=new Jt,r=me(e,[],n,t);return JSON.stringify(r,null,2)},se=(e,t,n,r)=>{const s=new Xt(n,r);return me(e,r,s,t)},Zt=(e="memimg",t="events")=>{let n,r=!1;const s=new Promise((o,i)=>{if(typeof indexedDB>"u"){i(new Error("IndexedDB not available (browser only)"));return}const c=indexedDB.open(e);c.onerror=()=>i(c.error),c.onsuccess=()=>{const d=c.result,l=d.objectStoreNames.contains(t),u=d.version;if(d.close(),l){const m=indexedDB.open(e,u);m.onerror=()=>i(m.error),m.onsuccess=()=>{n=m.result,o()}}else{const m=indexedDB.open(e,u+1);m.onerror=()=>i(m.error),m.onsuccess=()=>{n=m.result,o()},m.onupgradeneeded=y=>{const v=y.target.result;v.objectStoreNames.contains(t)||v.createObjectStore(t,{autoIncrement:!0})}}},c.onupgradeneeded=d=>{const l=d.target.result;l.objectStoreNames.contains(t)||l.createObjectStore(t,{autoIncrement:!0})}}),a=()=>{if(r)throw new Error(`EventLog (${t}) has been closed and cannot be used. This usually happens when switching between memory images.`)};return{append:async o=>(a(),await s,new Promise((i,c)=>{const u=n.transaction([t],"readwrite").objectStore(t).add(o);u.onsuccess=()=>i(),u.onerror=()=>c(u.error)})),getAll:async()=>(a(),await s,new Promise((o,i)=>{const l=n.transaction([t],"readonly").objectStore(t).getAll();l.onsuccess=()=>o(l.result),l.onerror=()=>i(l.error)})),clear:async()=>(a(),await s,new Promise((o,i)=>{const l=n.transaction([t],"readwrite").objectStore(t).clear();l.onsuccess=()=>o(),l.onerror=()=>i(l.error)})),close:async()=>{if(!r){r=!0;try{await s,n&&(n.close(),await new Promise(o=>setTimeout(o,50)))}catch(o){console.warn(`EventLog close(): Database was never initialized (${t})`,o)}}}}};class Qt{constructor(){this.delta=new Map,this.DELETED=Symbol("deleted")}getDeletedSymbol(){return this.DELETED}isDirty(){return this.delta.size>0}size(){return this.delta.size}has(t){return this.delta.has(t)}get(t){return this.delta.get(t)}set(t,n){this.delta.set(t,n)}delete(t){this.delta.set(t,this.DELETED)}isDeleted(t){return this.delta.get(t)===this.DELETED}clear(){this.delta.clear()}entries(){return Array.from(this.delta.entries()).sort((t,n)=>{const r=t[0].split(".").length,s=n[0].split(".").length;return r-s})}createCheckpoint(){return new Map(this.delta)}restoreCheckpoint(t){this.delta.clear();for(const[n,r]of t)this.delta.set(n,r)}}function en(e){return e!==null&&typeof e=="object"}function Ee(e,t,n=new WeakMap){if(!en(e))return e;if(n.has(e))return n.get(e);const r=t.has(e)?t.get(e):e;if(r!==e&&n.has(r)){const i=n.get(r);return n.set(e,i),i}if(r instanceof Map){const i=new Map;n.set(e,i),r!==e&&n.set(r,i);let c=!1;for(const[l,u]of r.entries()){const m=Ee(l,t,n),y=Ee(u,t,n);i.set(m,y),(m!==l||y!==u)&&(c=!0)}const d=c?i:r;return n.set(e,d),r!==e&&n.set(r,d),d}if(r instanceof Set){const i=new Set;n.set(e,i),r!==e&&n.set(r,i);let c=!1;for(const l of r.values()){const u=Ee(l,t,n);i.add(u),u!==l&&(c=!0)}const d=c?i:r;return n.set(e,d),r!==e&&n.set(r,d),d}if(Array.isArray(r)){const i=[];n.set(e,i),r!==e&&n.set(r,i);let c=!1;for(const l of r){const u=Ee(l,t,n);i.push(u),u!==l&&(c=!0)}const d=c?i:r;return n.set(e,d),r!==e&&n.set(r,d),d}const s={};n.set(e,s),r!==e&&n.set(r,s);let a=!1;for(const[i,c]of Object.entries(r)){const d=Ee(c,t,n);s[i]=d,d!==c&&(a=!0)}const o=a?s:r;return n.set(e,o),r!==e&&n.set(r,o),o}function ft(e){return e!==null&&typeof e=="object"}function Ve(e,t,n,r,s){if(r.has(e))return r.get(e);const a=t.getDeletedSymbol(),o=new Proxy(e,{get(i,c){if(typeof c=="symbol")return i[c];const d=[...n,String(c)],l=d.join(".");if(t.has(l)){const m=t.get(l);return m===a?void 0:ft(m)?s.has(m)?m:Ve(m,t,d,r,s):m}const u=i[c];if(typeof u=="function"&&Array.isArray(i)){const m=String(c);return["push","pop","shift","unshift","splice","sort","reverse"].includes(m)?function(...v){const S=n.join(".");let x;return t.has(S)?x=t.get(S):(x=[...i],t.set(S,x)),u.apply(x,v)}:u.bind(i)}return ft(u)?s.has(u)?u:Ve(u,t,d,r,s):u},set(i,c,d){const u=[...n,String(c)].join(".");return t.set(u,d),!0},has(i,c){const l=[...n,String(c)].join(".");return t.has(l)?t.get(l)!==a:c in i},deleteProperty(i,c){const l=[...n,String(c)].join(".");return t.delete(l),!0},ownKeys(i){const c=Reflect.ownKeys(i),d=n.length>0?n.join(".")+".":"",l=new Set;for(const[m,y]of t.entries())if(m.startsWith(d)){const v=m.slice(d.length),S=v.indexOf("."),x=S===-1?v:v.slice(0,S);y!==a&&l.add(x)}const u=new Set(c);for(const[m,y]of t.entries())if(m.startsWith(d)){const v=m.slice(d.length);if(v.indexOf(".")===-1){const x=v;y===a?u.delete(x):u.add(x)}}return Array.from(u)},getOwnPropertyDescriptor(i,c){const l=[...n,String(c)].join(".");if(t.has(l)){const u=t.get(l);return u===a?void 0:{value:u,writable:!0,enumerable:!0,configurable:!0}}return Reflect.getOwnPropertyDescriptor(i,c)}});return r.set(e,o),s.set(o,e),o}const tn=e=>typeof e=="object"&&e!==null&&"__type__"in e&&typeof e.__type__=="string",At=e=>{const n=new Function(`return (${e.sourceCode})`)();return n.__type__="function",n.sourceCode=e.sourceCode,n},Tt=(e,t,n)=>{if(!("__dateValue__"in e))throw new Error("Invalid Date serialization format: missing __dateValue__ field");const r=e.__dateValue__,s=r===null?new Date("invalid"):new Date(r);for(const[a,o]of Object.entries(e))a==="__type__"||a==="__dateValue__"||(s[a]=t(o,n));return s},_t=e=>BigInt(e.value),Pt=e=>Symbol(e.description),ke=e=>typeof e=="object"&&e!==null&&"__unresolved_ref__"in e,nn=(e,t)=>{var r,s;const n=new Map;for(const[a,o]of e.entries){const i=typeof a=="object"&&a!==null&&a.__type__&&((r=K[a.__type__])==null?void 0:r.call(K,a,t))||a,c=typeof o=="object"&&o!==null&&o.__type__&&((s=K[o.__type__])==null?void 0:s.call(K,o,t))||o;n.set(i,c)}return n},rn=(e,t)=>{var r;const n=new Set;for(const s of e.values){const a=typeof s=="object"&&s!==null&&s.__type__&&((r=K[s.__type__])==null?void 0:r.call(K,s,t))||s;n.add(a)}return n},K={function:e=>At(e),date:(e,t)=>Tt(e,(r,s)=>{if(r&&typeof r=="object"&&"__type__"in r){const a=K[r.__type__];return a?a(r,t):r}return r},t),bigint:e=>_t(e),symbol:e=>Pt(e),ref:e=>({__unresolved_ref__:e.path}),map:(e,t)=>nn(e,t),set:(e,t)=>rn(e,t)};function sn(e,t){const n=[];function r(a,o=[]){if(a===null||typeof a!="object")return a;if(a.__type__&&K[a.__type__]){const i=K[a.__type__];if(!i)return a;const c=i(a,e);if(c&&ke(c))return n.push({parent:null,key:null,path:c.__unresolved_ref__}),c;if(c instanceof Date){for(const d in c)if(Object.prototype.hasOwnProperty.call(c,d)){const l=c[d];l&&ke(l)&&n.push({parent:c,key:d,path:l.__unresolved_ref__})}}return c}for(const i in a)if(Object.prototype.hasOwnProperty.call(a,i)){const c=a[i];if(c&&typeof c=="object")if(c.__type__&&K[c.__type__]){const d=K[c.__type__];if(!d)continue;const l=d(c,e);if(l&&ke(l))n.push({parent:a,key:i,path:l.__unresolved_ref__});else if(a[i]=l,l instanceof Date){for(const u in l)if(Object.prototype.hasOwnProperty.call(l,u)){const m=l[u];m&&ke(m)&&n.push({parent:l,key:u,path:m.__unresolved_ref__})}}}else r(c,[...o,i])}return a}let s=r(e);for(const a of n){const{parent:o,key:i,path:c}=a,d=t(c,s);o&&i!==null?o[i]=d:o===null&&i===null&&(s=d)}return s}function on(e,t){return sn(e,(s,a)=>{let o=a,i=!0;for(const c of s){const d=o==null?void 0:o[c];if(d===void 0){i=!1;break}o=d}if(i)return o;o=t;for(const c of s){const d=o==null?void 0:o[c];if(d===void 0)throw new Error(`Cannot resolve event value ref path: ${s.join(".")} (not found in value scope or memory scope)`);o=d}return o})}const V=(e,t,n=new WeakMap)=>{if(e==null||typeof e!="object")return e;if(n.has(e))return n.get(e);if(tn(e)){const s=e;switch(s.__type__){case"function":return At(s);case"date":return Tt(s,(i,c)=>V(i,t,n),t);case"bigint":return _t(s);case"symbol":return Pt(s);case"ref":{const a=s;let o=t;for(const i of a.path)if(o=o[i],o===void 0)throw new Error(`Cannot resolve ref path: ${a.path.join(".")}`);return o}case"map":{const a=s,o=new Map;n.set(e,o);for(const[i,c]of a.entries){const d=V(i,t,n),l=V(c,t,n);o.set(d,l)}return o}case"set":{const a=s,o=new Set;n.set(e,o);for(const i of a.values)o.add(V(i,t,n));return o}case"circular":throw new Error("Encountered explicit circular marker - this indicates a serialization issue")}}if(Array.isArray(e)){const s=[];n.set(e,s);for(const a of e)s.push(V(a,t,n));return s}const r={};n.set(e,r);for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=V(e[s],t,n));return r};class an{createEvent(t,n,r){const[s]=n;return{type:L.SET,path:t,value:se(s,r.proxyToTarget,r.targetToPath,t),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t;n[r]=on(a.value,s)}}class cn{createEvent(t){return{type:L.DELETE,path:t,timestamp:Date.now()}}applyEvent(t,n,r){delete n[r]}}class ln{createEvent(t,n,r){return{type:L.ARRAY_PUSH,path:t,items:n.map(s=>se(s,r.proxyToTarget,r.targetToPath,t)),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r];for(const i of a.items)o.push(V(i,s))}}class dn{createEvent(t){return{type:L.ARRAY_POP,path:t,timestamp:Date.now()}}applyEvent(t,n,r){n[r].pop()}}class un{createEvent(t){return{type:L.ARRAY_SHIFT,path:t,timestamp:Date.now()}}applyEvent(t,n,r){n[r].shift()}}class fn{createEvent(t,n,r){return{type:L.ARRAY_UNSHIFT,path:t,items:n.map(s=>se(s,r.proxyToTarget,r.targetToPath,t)),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=a.items.map(c=>V(c,s));o.unshift(...i)}}class pn{createEvent(t,n,r){return{type:L.ARRAY_SPLICE,path:t,start:n[0],deleteCount:n[1]||0,items:n.slice(2).map(s=>se(s,r.proxyToTarget,r.targetToPath,t)),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=a.items.map(c=>V(c,s));o.splice(a.start,a.deleteCount,...i)}}class mn{createEvent(t){return{type:L.ARRAY_SORT,path:t,timestamp:Date.now()}}applyEvent(t,n,r){n[r].sort()}}class gn{createEvent(t){return{type:L.ARRAY_REVERSE,path:t,timestamp:Date.now()}}applyEvent(t,n,r){n[r].reverse()}}class hn{createEvent(t,n,r){return{type:L.ARRAY_FILL,path:t,value:se(n[0],r.proxyToTarget,r.targetToPath,t),start:n[1],end:n[2],timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=V(a.value,s);o.fill(i,a.start,a.end)}}class yn{createEvent(t,n){return{type:L.ARRAY_COPYWITHIN,path:t,target:n[0],start:n[1],end:n[2],timestamp:Date.now()}}applyEvent(t,n,r){const s=t;n[r].copyWithin(s.target,s.start,s.end)}}class En{createEvent(t,n,r){return{type:L.MAP_SET,path:t,key:se(n[0],r.proxyToTarget,r.targetToPath,t),value:se(n[1],r.proxyToTarget,r.targetToPath,t),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=V(a.key,s),c=V(a.value,s);o.set(i,c)}}class wn{createEvent(t,n,r){return{type:L.MAP_DELETE,path:t,key:se(n[0],r.proxyToTarget,r.targetToPath,t),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=V(a.key,s);o.delete(i)}}class bn{createEvent(t){return{type:L.MAP_CLEAR,path:t,timestamp:Date.now()}}applyEvent(t,n,r){n[r].clear()}}class vn{createEvent(t,n,r){return{type:L.SET_ADD,path:t,value:se(n[0],r.proxyToTarget,r.targetToPath,t),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=V(a.value,s);o.add(i)}}class Sn{createEvent(t,n,r){return{type:L.SET_DELETE,path:t,value:se(n[0],r.proxyToTarget,r.targetToPath,t),timestamp:Date.now()}}applyEvent(t,n,r,s){const a=t,o=n[r],i=V(a.value,s);o.delete(i)}}class xn{createEvent(t){return{type:L.SET_CLEAR,path:t,timestamp:Date.now()}}applyEvent(t,n,r){n[r].clear()}}class An{createEvent(t,n){return{type:L.SCRIPT,path:t,source:n[0],timestamp:Date.now()}}applyEvent(){}}class Tn{constructor(){this.handlers=new Map}register(t,n){this.handlers.set(t,n)}createEvent(t,n,r,s){const a=this.handlers.get(t);if(!a)throw new Error(`No handler registered for event type: ${t}`);return a.createEvent(n,r,s)}applyEvent(t,n,r,s){const a=this.handlers.get(t.type);if(!a)throw new Error(`No handler registered for event type: ${t.type}`);a.applyEvent(t,n,r,s)}hasHandler(t){return this.handlers.has(t)}}const Y=new Tn;Y.register(L.SET,new an);Y.register(L.DELETE,new cn);Y.register(L.ARRAY_PUSH,new ln);Y.register(L.ARRAY_POP,new dn);Y.register(L.ARRAY_SHIFT,new un);Y.register(L.ARRAY_UNSHIFT,new fn);Y.register(L.ARRAY_SPLICE,new pn);Y.register(L.ARRAY_SORT,new mn);Y.register(L.ARRAY_REVERSE,new gn);Y.register(L.ARRAY_FILL,new hn);Y.register(L.ARRAY_COPYWITHIN,new yn);Y.register(L.MAP_SET,new En);Y.register(L.MAP_DELETE,new wn);Y.register(L.MAP_CLEAR,new bn);Y.register(L.SET_ADD,new vn);Y.register(L.SET_DELETE,new Sn);Y.register(L.SET_CLEAR,new xn);Y.register(L.SCRIPT,new An);const pt=(e,t)=>{let n=e;for(let s=0;s<t.path.length-1;s++){const a=t.path[s];if(a){if(!(a in n)){const o=t.path[s+1];n[a]=o&&/^\d+$/.test(o)?[]:{}}n=n[a]}}const r=t.path[t.path.length-1];r&&Y.applyEvent(t,n,r,e)},mt=async(e,t,n)=>{if(n.isReplaying=!0,Array.isArray(t))for(const r of t)pt(e,r);else for await(const r of t)pt(e,r);n.isReplaying=!1},_n=async(e,t,n)=>{if(t.stream)await mt(e,t.stream(),n);else{const r=await t.getAll();await mt(e,r,n)}};async function Qe(e){const t=new Qt,n=t.getDeletedSymbol(),r=new WeakMap,s=new WeakMap,a={};return await _n(a,e,{isReplaying:!0}),{root:Ve(a,t,[],r,s),isDirty(){return t.isDirty()},getUncommittedCount(){return t.size()},async save(){const i=t.entries(),c=new WeakMap,d=(l,u,m=[])=>{if(!(u===null||typeof u!="object")&&!l.has(u))if(l.set(u,m),Array.isArray(u))u.forEach((y,v)=>d(l,y,[...m,String(v)]));else if(u instanceof Map){let y=0;u.forEach(v=>d(l,v,[...m,`map:${y++}`]))}else if(u instanceof Set){let y=0;u.forEach(v=>d(l,v,[...m,`set:${y++}`]))}else u instanceof Date||Object.entries(u).forEach(([y,v])=>d(l,v,[...m,y]))};for(const[l,u]of i){const m=new WeakMap;d(m,a);const y=l.split(".");let v=a;for(let x=0;x<y.length-1;x++)v=v[y[x]];const S=y[y.length-1];if(u===n)delete v[S],await e.append({type:"DELETE",path:y,timestamp:Date.now()});else{const x=Ee(u,s,c),I=se(x,new WeakMap,m,y);v[S]=x,await e.append({type:"SET",path:y,value:I,timestamp:Date.now()})}}t.clear()},discard(){t.clear()},createCheckpoint(){return t.createCheckpoint()},restoreCheckpoint(i){t.restoreCheckpoint(i)},unwrap(i){return Ee(i,s)}}}class Pn{constructor(){this._history=[["root"]],this._currentIndex=0,this._selectedPath=["root"],this._expandedPaths=new Set(["root"]),this._expandedNestedObjects=new Set,this.onNavigate=null}get selectedPath(){return[...this._selectedPath]}get currentIndex(){return this._currentIndex}get history(){return this._history.map(t=>[...t])}expandAncestors(t){for(let n=1;n<=t.length;n++){const r=t.slice(0,n).join(".");this._expandedPaths.add(r)}}reset(){this._selectedPath=["root"],this._expandedPaths=new Set(["root"]),this._expandedNestedObjects=new Set,this._history=[["root"]],this._currentIndex=0}navigateTo(t,n=!0){n&&(this._history=this._history.slice(0,this._currentIndex+1),this._history.push([...t]),this._currentIndex=this._history.length-1),this.expandAncestors(t),this._selectedPath=[...t],this.onNavigate&&this.onNavigate()}goBack(){this.canGoBack()&&(this._currentIndex--,this._selectedPath=[...this._history[this._currentIndex]],this.expandAncestors(this._selectedPath),this.onNavigate&&this.onNavigate())}goForward(){this.canGoForward()&&(this._currentIndex++,this._selectedPath=[...this._history[this._currentIndex]],this.expandAncestors(this._selectedPath),this.onNavigate&&this.onNavigate())}canGoBack(){return this._currentIndex>0}canGoForward(){return this._currentIndex<this._history.length-1}toggleExpanded(t){this._expandedPaths.has(t)?this._expandedPaths.delete(t):this._expandedPaths.add(t)}isExpanded(t){return this._expandedPaths.has(t)}toggleNestedExpanded(t){this._expandedNestedObjects.has(t)?this._expandedNestedObjects.delete(t):this._expandedNestedObjects.add(t)}isNestedExpanded(t){return this._expandedNestedObjects.has(t)}}const In=new WeakMap,Nn=e=>In.get(e)||null;function Ln(e,t){if(e===t)return["root"];if(!e||typeof e!="object")return null;const n=[[e,["root"]]],r=new Set;for(r.add(e);n.length>0;){const[s,a]=n.shift(),o=s instanceof Map?Array.from(s.entries()):s instanceof Set?Array.from(s.values()).map((i,c)=>[`[${c}]`,i]):Object.entries(s);for(const[i,c]of o)if(!(typeof i=="string"&&i.startsWith("__"))){if(c===t)return[...a,String(i)];c&&typeof c=="object"&&!r.has(c)&&(r.add(c),n.push([c,[...a,String(i)]]))}}return null}function et(e,t){const n=Nn(e);if(n){const{targetToPath:r,proxyToTarget:s}=n,a=s.get(t)||t,o=r.get(a);if(o)return["root",...o]}return Ln(e,t)}class Cn{getChildren(t){return t.map((r,s)=>[`[${s}]`,r])}createChildPath(t,n){return[...t,n.toString()]}}class Rn{getChildren(t){const n=t;return Array.from(n.entries()).map(([r,s])=>[String(r),s])}createChildPath(t,n){return[...t,`map:${n}`]}}class kn{getChildren(t){const n=t;return Array.from(n.values()).map((r,s)=>[`[${s}]`,r])}createChildPath(t,n){return[...t,`set:${n}`]}}function tt(e){return Array.isArray(e)?new Cn:e instanceof Map?new Rn:e instanceof Set?new kn:null}function gt(e){if(e==null)return!1;const t=typeof e;return t==="object"||t==="function"}function Dn(e){return e==null?"○":Array.isArray(e)?"[]":typeof e=="object"?"{}":typeof e=="function"?"ƒ":"•"}function On(e,t,n){if(!gt(e))return[];const r=tt(e);return r?r.getChildren(e):Object.entries(e).filter(([o,i])=>{if(o.startsWith("__")||!gt(i))return!1;if(typeof i=="object"&&i!==null){const c=et(n,i);if(c){const d=t.join("."),l=c.join(".");if(!l.startsWith(d+".")&&l!==d)return!1}}return!0})}function Fn(e,t,n,r,s,a){const o=document.createElement("div");o.className="tree-node-header",a&&o.classList.add("selected");const i=document.createElement("span");i.className=r?s?"tree-toggle expanded":"tree-toggle collapsed":"tree-toggle leaf";const c=document.createElement("span");c.className="tree-icon",c.textContent=Dn(t);const d=document.createElement("span");return d.className="tree-label",d.textContent=e,o.appendChild(i),o.appendChild(c),o.appendChild(d),o}function Mn(e,t,n,r,s,a,o){const i=n.join(".");e.querySelector(".tree-toggle").addEventListener("click",d=>{d.stopPropagation(),s&&(a.toggleExpanded(i),o&&o())}),e.addEventListener("click",d=>{d.stopPropagation();let l=n;if(t!=null&&(typeof t=="object"||typeof t=="function")){const u=et(r,t);u&&(l=[...u])}a.navigateTo(l,!0),o&&o()})}function Bn(e,t,n,r,s,a){const o=document.createElement("div");o.className="tree-children expanded";const i=tt(e);return i?$n(o,n,t,i,r,s,a):Hn(o,n,t,r,s,a),o}function $n(e,t,n,r,s,a,o){if(!r)return;let i=0;for(const[c,d]of t){const l=r.createChildPath(n,i);e.appendChild(nt(c,d,l,s,a,o)),i++}}function Hn(e,t,n,r,s,a){for(const[o,i]of t){const c=[...n,o];e.appendChild(nt(o,i,c,r,s,a))}}function nt(e,t,n,r,s,a){const o=document.createElement("div");o.className="tree-node";const i=n.join("."),c=i===s.selectedPath.join("."),d=On(t,n,r),l=d.length>0,u=s.isExpanded(i),m=Fn(e,t,n,l,u,c);if(Mn(m,t,n,r,l,s,a),o.appendChild(m),l&&u){const y=Bn(t,n,d,r,s,a);o.appendChild(y)}return o}function Un(e,t,n,r){n.innerHTML="";const s=nt("this",e,["root"],e,t,r);n.appendChild(s)}const Oe="__",D={PROPERTY_TABLE:"property-table",PROPERTY_NAME:"property-name",PROPERTY_VALUE:"property-value",EMPTY_STATE:"empty-state",VALUE_NAVIGABLE:"value-navigable",VALUE_NULL:"value-null",VALUE_UNDEFINED:"value-undefined",VALUE_STRING:"value-string",VALUE_NUMBER:"value-number",VALUE_BOOLEAN:"value-boolean",VALUE_BIGINT:"value-bigint",VALUE_SYMBOL:"value-symbol",VALUE_DATE:"value-date",VALUE_FUNCTION:"value-function",VALUE_ARRAY:"value-array",VALUE_MAP:"value-map",VALUE_SET:"value-set",VALUE_OBJECT:"value-object"},Te={MAX_PREVIEW_LENGTH:80,MAX_OBJECT_PROPERTIES_PREVIEW:5},jn=/name|desc(ription)?$/i,Z={NULL:"∅",UNDEFINED:"∅",STRING:'"',NUMBER:"#",BOOLEAN:"✓",BIGINT:"#n",SYMBOL:"Σ",DATE:"📅",FUNCTION:"ƒ",ARRAY:"[]",MAP:"M{}",SET:"S{}",OBJECT:"{}"};let Ge=null;function rt(e){Ge=e}function Pe(e){return Ge?Ge(e):e}var J=(e=>(e[e.NULL=1]="NULL",e[e.UNDEFINED=2]="UNDEFINED",e[e.STRING=3]="STRING",e[e.NUMBER=4]="NUMBER",e[e.BOOLEAN=5]="BOOLEAN",e[e.BIGINT=6]="BIGINT",e[e.SYMBOL=7]="SYMBOL",e[e.DATE=8]="DATE",e[e.FUNCTION=9]="FUNCTION",e[e.ARRAY=10]="ARRAY",e[e.MAP=11]="MAP",e[e.SET=12]="SET",e[e.OBJECT=13]="OBJECT",e))(J||{});function st(e){if(e===null)return{category:1,typeName:"null",isNavigable:!1,isCollection:!1,displayIcon:Z.NULL,cssClass:D.VALUE_NULL};if(e===void 0)return{category:2,typeName:"undefined",isNavigable:!1,isCollection:!1,displayIcon:Z.UNDEFINED,cssClass:D.VALUE_UNDEFINED};const t=typeof e;return t==="string"?{category:3,typeName:"string",isNavigable:!1,isCollection:!1,displayIcon:Z.STRING,cssClass:D.VALUE_STRING}:t==="number"?{category:4,typeName:"number",isNavigable:!1,isCollection:!1,displayIcon:Z.NUMBER,cssClass:D.VALUE_NUMBER}:t==="boolean"?{category:5,typeName:"boolean",isNavigable:!1,isCollection:!1,displayIcon:Z.BOOLEAN,cssClass:D.VALUE_BOOLEAN}:t==="bigint"?{category:6,typeName:"bigint",isNavigable:!1,isCollection:!1,displayIcon:Z.BIGINT,cssClass:D.VALUE_BIGINT}:t==="symbol"?{category:7,typeName:"symbol",isNavigable:!1,isCollection:!1,displayIcon:Z.SYMBOL,cssClass:D.VALUE_SYMBOL}:Ie(e)?{category:8,typeName:"Date",isNavigable:!0,isCollection:!1,displayIcon:Z.DATE,cssClass:D.VALUE_DATE}:t==="function"?{category:9,typeName:"Function",isNavigable:!0,isCollection:!1,displayIcon:Z.FUNCTION,cssClass:D.VALUE_FUNCTION}:Array.isArray(e)?{category:10,typeName:"Array",isNavigable:!0,isCollection:!0,displayIcon:Z.ARRAY,cssClass:D.VALUE_ARRAY}:e instanceof Map?{category:11,typeName:"Map",isNavigable:!0,isCollection:!0,displayIcon:Z.MAP,cssClass:D.VALUE_MAP}:e instanceof Set?{category:12,typeName:"Set",isNavigable:!0,isCollection:!0,displayIcon:Z.SET,cssClass:D.VALUE_SET}:{category:13,typeName:"Object",isNavigable:!0,isCollection:!1,displayIcon:Z.OBJECT,cssClass:D.VALUE_OBJECT}}const zn=Gt;function Ie(e){if(e==null||typeof e!="object")return!1;if(e instanceof Date)return!0;let t=e;for(let n=0;n<5;n++){const r=Pe(t);if(r===t)break;if(r instanceof Date)return!0;if(typeof r!="object"||r===null)break;t=r}try{let n=Object.getPrototypeOf(e);for(;n!==null;){if(n===Date.prototype)return!0;n=Object.getPrototypeOf(n)}}catch{}return typeof e.getTime=="function"&&typeof e.toISOString=="function"}function Yn(e){if(e==null||typeof e!="object"||zn(e))return!1;const t=Object.entries(e).filter(([n])=>!n.startsWith("__"));if(Ie(e)){if(t.length===0||t.length>5)return!1}else if(t.length>5)return!1;return t.every(([n,r])=>{if(r==null)return!0;const s=typeof r;return!!(s==="string"||s==="number"||s==="boolean"||s==="bigint"||Ie(r))})}class qn{canFormat(t){return t.category===J.NULL}formatPreview(t){return""}formatFull(t){return""}}class Wn{canFormat(t){return t.category===J.UNDEFINED}formatPreview(t){return"undefined"}formatFull(t){return"undefined"}}class Vn{canFormat(t){return t.category===J.STRING}formatPreview(t,n=Te.MAX_PREVIEW_LENGTH){const r=String(t);return r.length>n?r.substring(0,n)+"...":r}formatFull(t){return String(t)}}class Gn{canFormat(t){return t.category===J.NUMBER}formatPreview(t){return String(t)}formatFull(t){return String(t)}}class Kn{canFormat(t){return t.category===J.BOOLEAN}formatPreview(t){return String(t)}formatFull(t){return String(t)}}class Jn{canFormat(t){return t.category===J.BIGINT}formatPreview(t){return t.toString()+"n"}formatFull(t){return t.toString()+"n"}}class Xn{canFormat(t){return t.category===J.SYMBOL}formatPreview(t){return t.toString()}formatFull(t){return t.toString()}}class Zn{canFormat(t){return t.category===J.DATE}formatPreview(t){const n=Pe(t),r=isNaN(n.getTime())?"Invalid Date":n.toISOString(),s=Object.keys(t).filter(a=>!a.startsWith("__")).length;return s>0?`${r} {${s}}`:r}formatFull(t){const n=Pe(t),r=isNaN(n.getTime())?"Invalid Date":n.toISOString(),s=Object.keys(t).filter(a=>!a.startsWith("__")).length;return s>0?`Date(${r}) {${s}}`:r}}class Qn{canFormat(t){return t.category===J.FUNCTION}formatPreview(t){return"ƒ "+(t.name||"(anonymous)")}formatFull(t){return"ƒ "+(t.name||"(anonymous)")}}class er{canFormat(t){return t.category===J.ARRAY}formatPreview(t,n=Te.MAX_PREVIEW_LENGTH){const r=t;try{const s=JSON.stringify(r,null,0);return s.length>n?s.substring(0,n)+"...":s}catch{return`[Array(${r.length})]`}}formatFull(t){return`Array(${t.length})`}}class tr{canFormat(t){return t.category===J.MAP}formatPreview(t){return`Map{${t.size}}`}formatFull(t){return`Map{${t.size}}`}}class nr{canFormat(t){return t.category===J.SET}formatPreview(t){return`Set{${t.size}}`}formatFull(t){return`Set{${t.size}}`}}function Fe(e){if(e==null)return"";const t=typeof e;if(t!=="object"&&t!=="function")return String(e);if(Ie(e))return Pe(e).toISOString();if(Array.isArray(e))return`[${e.length} items]`;if(e instanceof Map)return`Map{${e.size}}`;if(e instanceof Set)return`Set{${e.size}}`;const n=[],r=Object.entries(e).filter(([a])=>!a.startsWith(Oe));for(const[a,o]of r)if(jn.test(a)){if(typeof o=="string")n.push(o);else if(o!==null&&typeof o=="object"&&!Ie(o)&&!Array.isArray(o)&&!(o instanceof Map)&&!(o instanceof Set)){const i=Fe(o);i&&!i.startsWith("Object{")&&n.push(i)}}return n.length>0?n.join(" "):`Object{${r.length}}`}class rr{canFormat(t){return t.category===J.OBJECT}formatPreview(t,n=Te.MAX_PREVIEW_LENGTH){const r=t,s=Pe(t);if(s instanceof Date){const l=isNaN(s.getTime())?"Invalid Date":s.toISOString(),u=Object.keys(r).filter(m=>!m.startsWith("__")).length;return u>0?`${l} {${u}}`:l}const a=Fe(r);if(a&&!a.startsWith("Object{"))return a.length>n?a.substring(0,n)+"...":a;const o=Object.entries(r).filter(([l])=>!l.startsWith(Oe)).slice(0,Te.MAX_OBJECT_PROPERTIES_PREVIEW);if(o.length===0)return a;const i=o.map(([l,u])=>u===null?`"${l}":null`:u===void 0?`"${l}":undefined`:typeof u=="string"?`"${l}":"${u}"`:typeof u=="number"||typeof u=="boolean"?`"${l}":${u}`:Array.isArray(u)?`"${l}":[Array]`:typeof u=="object"?`"${l}":[Object]`:typeof u=="function"?`"${l}":[Function]`:`"${l}":${typeof u}`),c=Object.keys(r).filter(l=>!l.startsWith(Oe)).length>Te.MAX_OBJECT_PROPERTIES_PREVIEW,d="{"+i.join(",")+(c?",...":"")+"}";return d.length>n?d.substring(0,n)+"...":d}formatFull(t){return Fe(t)}}const sr=[new qn,new Wn,new Vn,new Gn,new Kn,new Jn,new Xn,new Zn,new Qn,new er,new tr,new nr,new rr];function or(e,t="preview",n){const r=st(e),s=sr.find(a=>a.canFormat(r));return s?t==="preview"?s.formatPreview(e,n):s.formatFull(e):String(e)}function Be(e,t="preview",n){const r=st(e);return[or(e,t,n),r]}function ar(e){if(e==null)return[];try{const n=Reflect.ownKeys(e).filter(s=>typeof s=="string");if(n.length>0)return n.map(s=>[s,e[s]]);const r=Object.entries(e);return r.length>0?r:[]}catch(t){return console.error("Failed to enumerate object properties with Reflect.ownKeys:",t),Object.entries(e)}}function ir(e){return ar(e).filter(([t])=>!t.startsWith(Oe))}function cr(e){const t=ir(e),n=[],r=[];for(const[s,a]of t)st(a).isCollection?r.push([s,a]):n.push([s,a]);return{scalars:n,collections:r}}function It(e,t){let n=e;for(let r=1;r<t.length;r++){const s=t[r];if(s===void 0)return;if(!(s===""&&!(s in n))&&(n=n==null?void 0:n[s],n===void 0))return}return n}function lr(e){const t=document.createElement("div");t.className="inspector-tabs";const n=document.createElement("div");n.className="tab-headers";const r=document.createElement("div");r.className="tab-content";const s=e.findIndex(o=>!o.isEmpty),a=s>=0?s:0;return e.forEach((o,i)=>{const c=document.createElement("button");c.className="tab-header",c.textContent=o.label,c.disabled=o.isEmpty,c.dataset.tabId=o.id,i===a&&c.classList.add("active"),c.addEventListener("click",()=>{n.querySelectorAll(".tab-header").forEach(d=>d.classList.remove("active")),r.querySelectorAll(".tab-panel").forEach(d=>d.classList.remove("active")),c.classList.add("active"),o.content.classList.add("active")}),n.appendChild(c),o.content.className="tab-panel",o.content.dataset.tabId=o.id,i===a&&o.content.classList.add("active"),r.appendChild(o.content)}),t.appendChild(n),t.appendChild(r),t}function dr(e,t,n,r,s,a){const o=document.createElement("td");o.className=D.PROPERTY_VALUE;const[i,c]=Be(e,"preview");return o.textContent=i,o.title=c.typeName,o.classList.add(c.cssClass),c.isNavigable&&(o.classList.add(D.VALUE_NAVIGABLE),o.addEventListener("click",()=>{Nt(n,r,t,s,a)})),o}function ur(e,t,n,r,s){const a=document.createElement("td");a.className=D.PROPERTY_VALUE;const o=`${n.join(".")}.${t}`,i=r.isNestedExpanded(o),c=Fe(e),d=document.createElement("div");d.className="value-nested";const l=document.createElement("span");l.className=`value-nested-toggle ${i?"expanded":"collapsed"}`;const u=document.createElement("span");u.className="value-nested-summary",u.textContent=`{${c}}`,d.appendChild(l),d.appendChild(u);const m=document.createElement("div");m.className=`nested-properties ${i?"expanded":""}`;for(const[v,S]of Object.entries(e)){if(v.startsWith("__"))continue;const x=document.createElement("div");x.className="nested-prop";const I=document.createElement("span");I.className="nested-prop-key",I.textContent=`${v}:`;const[p,g]=Be(S,"preview"),h=document.createElement("span");h.className=`nested-prop-value ${g.cssClass}`,h.textContent=p,x.appendChild(I),x.appendChild(h),m.appendChild(x)}a.appendChild(d),a.appendChild(m);let y=null;return d.addEventListener("click",v=>{if(v.stopPropagation(),y){clearTimeout(y),y=null;return}y=setTimeout(()=>{y=null,r.toggleNestedExpanded(o),s&&s()},250)}),d.addEventListener("dblclick",v=>{v.stopPropagation(),y&&(clearTimeout(y),y=null);const S=[...n,t];r.navigateTo(S,!0),s&&s()}),a}function Nt(e,t,n,r,s){const a=It(e,t),o=a==null?void 0:a[n];if(!o){console.error("Could not find referenced object");return}const i=et(e,o);if(!i){console.error("Could not find canonical path for object");return}r.navigateTo([...i],!0),s&&s()}function fr(e,t,n,r,s,a){const o=document.createElement("tr"),i=document.createElement("td");i.className=D.PROPERTY_NAME,i.textContent=e;const c=Yn(t)?ur(t,e,r,s,a):dr(t,e,n,r,s,a);return o.appendChild(i),o.appendChild(c),o}function pr(e,t,n,r,s){const a=document.createElement("table");a.className=D.PROPERTY_TABLE;const o=document.createElement("thead");o.innerHTML="<tr><th>Property</th><th>Value</th></tr>",a.appendChild(o);const i=document.createElement("tbody");for(const[c,d]of e)i.appendChild(fr(c,d,t,n,r,s));return a.appendChild(i),a}function mr(e,t,n,r,s){const a=document.createElement("div");if(a.className="collections-panel",e.length===0)return a.innerHTML=`<div class="${D.EMPTY_STATE}">No collections</div>`,a;for(const[o,i]of e){const c=document.createElement("div");c.className="collection-section";const d=document.createElement("h3");d.textContent=o,d.className="collection-header",c.appendChild(d);const l=tt(i);if(!l){const m=document.createElement("div");m.className=D.EMPTY_STATE,m.textContent="Unknown collection type",c.appendChild(m),a.appendChild(c);continue}const u=l.getChildren(i);if(u.length===0){const m=document.createElement("div");m.className=D.EMPTY_STATE,m.textContent="Empty collection",c.appendChild(m)}else{const m=document.createElement("ul");m.className="collection-items";for(const[y,v]of u){const S=document.createElement("li");S.className="collection-item";const[x,I]=Be(v,"preview"),p=document.createElement("span");p.className="item-label",p.textContent=`${y}: `;const g=document.createElement("span");g.className=`item-value ${I.cssClass}`,g.textContent=x,g.title=I.typeName,S.appendChild(p),S.appendChild(g),I.isNavigable&&(g.classList.add(D.VALUE_NAVIGABLE),g.addEventListener("click",()=>{const h=[...n,o];Nt(t,h,y,r,s)})),m.appendChild(S)}c.appendChild(m)}a.appendChild(c)}return a}function gr(e,t,n,r){const s=t.selectedPath;if(s.length===0){n.innerHTML=`<div class="${D.EMPTY_STATE}">Select a node in the tree</div>`;return}const a=It(e,s);if(a==null){n.innerHTML=`<div class="${D.EMPTY_STATE}">Value is ${a===null?"null":"undefined"}</div>`;return}if(typeof a!="object"&&typeof a!="function"){const[l]=Be(a,"preview");n.innerHTML=`<div class="${D.EMPTY_STATE}">Primitive value: ${l}</div>`;return}const{scalars:o,collections:i}=cr(a);if(o.length===0&&i.length===0){n.innerHTML=`<div class="${D.EMPTY_STATE}">No properties</div>`;return}const c=[{id:"properties",label:"Properties",content:pr(o,e,s,t,r),isEmpty:o.length===0},{id:"collections",label:"Collections",content:mr(i,e,s,t,r),isEmpty:i.length===0}],d=lr(c);n.innerHTML="",n.appendChild(d)}const _e="memimg-explorer",Ke=1e3,hr=100*1024;function yr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function ot(e){return`script-history-${e}`}async function Er(e){const t=ot(e);return new Promise((n,r)=>{const s=indexedDB.open(_e);s.onerror=()=>{r(s.error)},s.onsuccess=async()=>{const a=s.result,o=a.objectStoreNames.contains(t),i=a.version;if(a.close(),await new Promise(d=>setTimeout(d,50)),o){n();return}const c=indexedDB.open(_e,i+1);c.onerror=()=>{r(c.error)},c.onblocked=()=>{},c.onsuccess=async()=>{c.result.close(),await new Promise(d=>setTimeout(d,50)),n()},c.onupgradeneeded=d=>{const l=d.target.result;if(!l.objectStoreNames.contains(t)){const u=l.createObjectStore(t,{keyPath:"id"});u.createIndex("timestamp","timestamp",{unique:!1}),u.createIndex("characterCount","characterCount",{unique:!1})}}},s.onupgradeneeded=a=>{const o=a.target.result;if(!o.objectStoreNames.contains(t)){const i=o.createObjectStore(t,{keyPath:"id"});i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("characterCount","characterCount",{unique:!1})}}})}async function Ne(e,t="readonly"){const n=ot(e);return new Promise((r,s)=>{const a=indexedDB.open(_e);a.onerror=()=>s(a.error),a.onsuccess=async()=>{const o=a.result,i=!o.objectStoreNames.contains(n),c=o.version;if(o.close(),await new Promise(d=>setTimeout(d,50)),i){const d=indexedDB.open(_e,c+1);d.onerror=()=>s(d.error),d.onsuccess=()=>{const l=d.result;try{const m=l.transaction([n],t).objectStore(n);r({db:l,store:m})}catch(u){l.close(),s(u)}},d.onupgradeneeded=l=>{const u=l.target.result,m=l.target.transaction;if(!u.objectStoreNames.contains(n)){const y=u.createObjectStore(n,{keyPath:"id"});y.createIndex("timestamp","timestamp",{unique:!1}),y.createIndex("characterCount","characterCount",{unique:!1})}m.oncomplete=()=>{console.log(`Script history store created: ${n}`)}}}else{const d=indexedDB.open(_e);d.onerror=()=>s(d.error),d.onsuccess=()=>{const l=d.result,m=l.transaction([n],t).objectStore(n);r({db:l,store:m})}}},a.onupgradeneeded=o=>{const i=o.target.result;if(!i.objectStoreNames.contains(n)){const c=i.createObjectStore(n,{keyPath:"id"});c.createIndex("timestamp","timestamp",{unique:!1}),c.createIndex("characterCount","characterCount",{unique:!1})}}})}async function wr(e,t){const n=new Blob([t]).size;if(n>hr)throw new Error(`Script too large: ${(n/1024).toFixed(1)} KB (max 100 KB)`);const r={id:yr(),timestamp:Date.now(),code:t,status:"success",characterCount:t.length},{db:s,store:a}=await Ne(e,"readwrite");return new Promise((o,i)=>{const c=a.count();c.onsuccess=()=>{const d=c.result;if(d>=Ke){const l=d-Ke+1,m=a.index("timestamp").openCursor(null,"next");let y=0;const v=[];m.onsuccess=()=>{const S=m.result;if(S&&y<l)v.push(S.value.id),y++,S.continue();else{for(const I of v)a.delete(I);const x=a.add(r);x.onsuccess=async()=>{s.close(),await new Promise(I=>setTimeout(I,50)),o()},x.onerror=async()=>{s.close(),await new Promise(I=>setTimeout(I,50)),i(x.error)}}},m.onerror=async()=>{s.close(),await new Promise(S=>setTimeout(S,50)),i(m.error)}}else{const l=a.add(r);l.onsuccess=async()=>{s.close(),await new Promise(u=>setTimeout(u,50)),o()},l.onerror=async()=>{s.close(),await new Promise(u=>setTimeout(u,50)),i(l.error)}}},c.onerror=async()=>{s.close(),await new Promise(d=>setTimeout(d,50)),i(c.error)}})}async function $e(e,t=100){const{db:n,store:r}=await Ne(e,"readonly");return new Promise((s,a)=>{const i=r.index("timestamp").openCursor(null,"prev"),c=[];i.onsuccess=async()=>{const d=i.result;d&&c.length<t?(c.push(d.value),d.continue()):(n.close(),await new Promise(l=>setTimeout(l,50)),s(c))},i.onerror=async()=>{n.close(),await new Promise(d=>setTimeout(d,50)),a(i.error)}})}async function br(e,t){if(!t||t.trim().length===0)return $e(e,100);const{db:n,store:r}=await Ne(e,"readonly"),s=t.toLowerCase();return new Promise((a,o)=>{const c=r.index("timestamp").openCursor(null,"prev"),d=[];c.onsuccess=async()=>{const l=c.result;if(l){const u=l.value;u.code.toLowerCase().includes(s)&&d.push(u),l.continue()}else n.close(),await new Promise(u=>setTimeout(u,50)),a(d)},c.onerror=async()=>{n.close(),await new Promise(l=>setTimeout(l,50)),o(c.error)}})}async function vr(e){const{db:t,store:n}=await Ne(e,"readwrite");return new Promise((r,s)=>{const a=n.clear();a.onsuccess=async()=>{t.close(),await new Promise(o=>setTimeout(o,50)),r()},a.onerror=async()=>{t.close(),await new Promise(o=>setTimeout(o,50)),s(a.error)}})}async function Sr(e){const t=await $e(e,Ke),n={memimgId:e,exportedAt:new Date().toISOString(),entryCount:t.length,entries:t.map(r=>({timestamp:r.timestamp,timestampISO:new Date(r.timestamp).toISOString(),code:r.code,characterCount:r.characterCount}))};return JSON.stringify(n,null,2)}async function xr(e){const{db:t,store:n}=await Ne(e,"readonly");return new Promise((r,s)=>{const a=n.count();a.onsuccess=()=>{const o=a.result,i=n.openCursor();let c=0;i.onsuccess=async()=>{const d=i.result;if(d){const l=d.value;c+=l.characterCount,d.continue()}else t.close(),await new Promise(l=>setTimeout(l,50)),r({count:o,totalSize:c})},i.onerror=async()=>{t.close(),await new Promise(d=>setTimeout(d,50)),s(i.error)}},a.onerror=async()=>{t.close(),await new Promise(o=>setTimeout(o,50)),s(a.error)}})}const Ar=window;function Tr(e,t,n={}){const r={tab:"	",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:Ar,autoclose:{open:`([{'"`,close:`)]}'"`},...n},s=r.window,a=s.document,o=[],i=[];let c=-1,d=!1,l=()=>{},u;e.setAttribute("contenteditable","plaintext-only"),e.setAttribute("spellcheck",r.spellcheck?"true":"false"),e.style.outline="none",e.style.overflowWrap="break-word",e.style.overflowY="auto",e.style.whiteSpace="pre-wrap";const m=(f,E)=>{t(f,E)},y=s.navigator.userAgent.match(/Firefox\/([0-9]+)\./),v=y?parseInt(y[1]):0;let S=!1;(e.contentEditable!=="plaintext-only"||v>=136)&&(S=!0),S&&e.setAttribute("contenteditable","true");const x=pe(()=>{const f=w();m(e,f),b(f)},30);let I=!1;const p=f=>!le(f)&&!ge(f)&&f.key!=="Meta"&&f.key!=="Control"&&f.key!=="Alt"&&!f.key.startsWith("Arrow"),g=pe(f=>{p(f)&&(ce(),I=!1)},300),h=(f,E)=>{o.push([f,E]),e.addEventListener(f,E)};h("keydown",f=>{f.defaultPrevented||(u=ne(),r.preserveIdent?F(f):$(f),r.catchTab&&Le(f),r.addClosing&&oe(f),r.history&&(Ce(f),p(f)&&!I&&(ce(),I=!0)),S&&!X(f)&&b(w()))}),h("keyup",f=>{f.defaultPrevented||f.isComposing||(u!==ne()&&x(),g(f),l(ne()))}),h("focus",f=>{d=!0}),h("blur",f=>{d=!1}),h("paste",f=>{ce(),je(f),ce(),l(ne())}),h("cut",f=>{ce(),Re(f),ce(),l(ne())});function w(){const f=de(),E={start:0,end:0,dir:void 0};let{anchorNode:A,anchorOffset:P,focusNode:k,focusOffset:M}=f;if(!A||!k)throw"error1";if(A===e&&k===e)return E.start=P>0&&e.textContent?e.textContent.length:0,E.end=M>0&&e.textContent?e.textContent.length:0,E.dir=M>=P?"->":"<-",E;if(A.nodeType===Node.ELEMENT_NODE){const U=a.createTextNode("");A.insertBefore(U,A.childNodes[P]),A=U,P=0}if(k.nodeType===Node.ELEMENT_NODE){const U=a.createTextNode("");k.insertBefore(U,k.childNodes[M]),k=U,M=0}return H(e,U=>{if(U===A&&U===k)return E.start+=P,E.end+=M,E.dir=P<=M?"->":"<-","stop";if(U===A)if(E.start+=P,!E.dir)E.dir="->";else return"stop";else if(U===k)if(E.end+=M,!E.dir)E.dir="<-";else return"stop";U.nodeType===Node.TEXT_NODE&&(E.dir!="->"&&(E.start+=U.nodeValue.length),E.dir!="<-"&&(E.end+=U.nodeValue.length))}),e.normalize(),E}function b(f){var dt,ut;const E=de();let A,P=0,k,M=0;if(f.dir||(f.dir="->"),f.start<0&&(f.start=0),f.end<0&&(f.end=0),f.dir=="<-"){const{start:ae,end:ue}=f;f.start=ue,f.end=ae}let U=0;H(e,ae=>{if(ae.nodeType!==Node.TEXT_NODE)return;const ue=(ae.nodeValue||"").length;if(U+ue>f.start&&(A||(A=ae,P=f.start-U),U+ue>f.end))return k=ae,M=f.end-U,"stop";U+=ue}),A||(A=e,P=e.childNodes.length),k||(k=e,M=e.childNodes.length),f.dir=="<-"&&([A,P,k,M]=[k,M,A,P]);{const ae=_(A);if(ae){const Ae=a.createTextNode("");(dt=ae.parentNode)==null||dt.insertBefore(Ae,ae),A=Ae,P=0}const ue=_(k);if(ue){const Ae=a.createTextNode("");(ut=ue.parentNode)==null||ut.insertBefore(Ae,ue),k=Ae,M=0}}E.setBaseAndExtent(A,P,k,M),e.normalize()}function _(f){for(;f&&f!==e;){if(f.nodeType===Node.ELEMENT_NODE){const E=f;if(E.getAttribute("contenteditable")=="false")return E}f=f.parentNode}}function N(){const E=de().getRangeAt(0),A=a.createRange();return A.selectNodeContents(e),A.setEnd(E.startContainer,E.startOffset),A.toString()}function T(){const E=de().getRangeAt(0),A=a.createRange();return A.selectNodeContents(e),A.setStart(E.endContainer,E.endOffset),A.toString()}function F(f){if(f.key==="Enter"){const E=N(),A=T();let[P]=he(E),k=P;if(r.indentOn.test(E)&&(k+=r.tab),k.length>0?(Q(f),f.stopPropagation(),q(`
`+k)):$(f),k!==P&&r.moveToNewLine.test(A)){const M=w();q(`
`+P),b(M)}}}function $(f){if(S&&f.key==="Enter")if(Q(f),f.stopPropagation(),T()==""){q(`
 `);const E=w();E.start=--E.end,b(E)}else q(`
`)}function oe(f){const E=r.autoclose.open,A=r.autoclose.close;if(E.includes(f.key)){Q(f);const P=w(),k=P.start==P.end?"":de().toString(),M=f.key+k+(A[E.indexOf(f.key)]??"");q(M),P.start++,P.end++,b(P)}}function Le(f){if(f.key==="Tab")if(Q(f),f.shiftKey){const E=N();let[A,P]=he(E);if(A.length>0){const k=w(),M=Math.min(r.tab.length,A.length);b({start:P,end:P+M}),a.execCommand("delete"),k.start-=M,k.end-=M,b(k)}}else q(r.tab)}function Ce(f){if(le(f)){Q(f),c--;const E=i[c];E&&(e.innerHTML=E.html,b(E.pos)),c<0&&(c=0)}if(ge(f)){Q(f),c++;const E=i[c];E&&(e.innerHTML=E.html,b(E.pos)),c>=i.length&&c--}}function ce(){if(!d)return;const f=e.innerHTML,E=w(),A=i[c];if(A&&A.html===f&&A.pos.start===E.start&&A.pos.end===E.end)return;c++,i[c]={html:f,pos:E},i.splice(c+1);const P=300;c>P&&(c=P,i.splice(0,1))}function je(f){if(f.defaultPrevented)return;Q(f);const A=(f.originalEvent??f).clipboardData.getData("text/plain").replace(/\r\n?/g,`
`),P=w();q(A),m(e),b({start:Math.min(P.start,P.end)+A.length,end:Math.min(P.start,P.end)+A.length,dir:"<-"})}function Re(f){const E=w(),A=de();(f.originalEvent??f).clipboardData.setData("text/plain",A.toString()),a.execCommand("delete"),m(e),b({start:Math.min(E.start,E.end),end:Math.min(E.start,E.end),dir:"<-"}),Q(f)}function H(f,E){const A=[];f.firstChild&&A.push(f.firstChild);let P=A.pop();for(;P&&E(P)!=="stop";)P.nextSibling&&A.push(P.nextSibling),P.firstChild&&A.push(P.firstChild),P=A.pop()}function G(f){return f.metaKey||f.ctrlKey}function le(f){return G(f)&&!f.shiftKey&&xe(f)==="Z"}function ge(f){return G(f)&&f.shiftKey&&xe(f)==="Z"}function X(f){return G(f)&&xe(f)==="C"}function xe(f){let E=f.key||f.keyCode||f.which;if(E)return(typeof E=="string"?E:String.fromCharCode(E)).toUpperCase()}function q(f){f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),a.execCommand("insertHTML",!1,f)}function pe(f,E){let A=0;return(...P)=>{clearTimeout(A),A=s.setTimeout(()=>f(...P),E)}}function he(f){let E=f.length-1;for(;E>=0&&f[E]!==`
`;)E--;E++;let A=E;for(;A<f.length&&/[ \t]/.test(f[A]);)A++;return[f.substring(E,A)||"",E,A]}function ne(){return e.textContent||""}function Q(f){f.preventDefault()}function de(){return e.getRootNode().getSelection()}return{updateOptions(f){Object.assign(r,f)},updateCode(f,E=!0){e.textContent=f,m(e),E&&l(f)},onUpdate(f){l=f},toString:ne,save:w,restore:b,recordHistory:ce,destroy(){for(let[f,E]of o)e.removeEventListener(f,E)}}}var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ze={exports:{}},yt;function Pr(){return yt||(yt=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=(function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,o={},i={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function p(g){return g instanceof c?new c(g.type,p(g.content),g.alias):Array.isArray(g)?g.map(p):g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(p){return Object.prototype.toString.call(p).slice(8,-1)},objId:function(p){return p.__id||Object.defineProperty(p,"__id",{value:++a}),p.__id},clone:function p(g,h){h=h||{};var w,b;switch(i.util.type(g)){case"Object":if(b=i.util.objId(g),h[b])return h[b];w={},h[b]=w;for(var _ in g)g.hasOwnProperty(_)&&(w[_]=p(g[_],h));return w;case"Array":return b=i.util.objId(g),h[b]?h[b]:(w=[],h[b]=w,g.forEach(function(N,T){w[T]=p(N,h)}),w);default:return g}},getLanguage:function(p){for(;p;){var g=s.exec(p.className);if(g)return g[1].toLowerCase();p=p.parentElement}return"none"},setLanguage:function(p,g){p.className=p.className.replace(RegExp(s,"gi"),""),p.classList.add("language-"+g)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(w){var p=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(w.stack)||[])[1];if(p){var g=document.getElementsByTagName("script");for(var h in g)if(g[h].src==p)return g[h]}return null}},isActive:function(p,g,h){for(var w="no-"+g;p;){var b=p.classList;if(b.contains(g))return!0;if(b.contains(w))return!1;p=p.parentElement}return!!h}},languages:{plain:o,plaintext:o,text:o,txt:o,extend:function(p,g){var h=i.util.clone(i.languages[p]);for(var w in g)h[w]=g[w];return h},insertBefore:function(p,g,h,w){w=w||i.languages;var b=w[p],_={};for(var N in b)if(b.hasOwnProperty(N)){if(N==g)for(var T in h)h.hasOwnProperty(T)&&(_[T]=h[T]);h.hasOwnProperty(N)||(_[N]=b[N])}var F=w[p];return w[p]=_,i.languages.DFS(i.languages,function($,oe){oe===F&&$!=p&&(this[$]=_)}),_},DFS:function p(g,h,w,b){b=b||{};var _=i.util.objId;for(var N in g)if(g.hasOwnProperty(N)){h.call(g,N,g[N],w||N);var T=g[N],F=i.util.type(T);F==="Object"&&!b[_(T)]?(b[_(T)]=!0,p(T,h,null,b)):F==="Array"&&!b[_(T)]&&(b[_(T)]=!0,p(T,h,N,b))}}},plugins:{},highlightAll:function(p,g){i.highlightAllUnder(document,p,g)},highlightAllUnder:function(p,g,h){var w={callback:h,container:p,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",w),w.elements=Array.prototype.slice.apply(w.container.querySelectorAll(w.selector)),i.hooks.run("before-all-elements-highlight",w);for(var b=0,_;_=w.elements[b++];)i.highlightElement(_,g===!0,w.callback)},highlightElement:function(p,g,h){var w=i.util.getLanguage(p),b=i.languages[w];i.util.setLanguage(p,w);var _=p.parentElement;_&&_.nodeName.toLowerCase()==="pre"&&i.util.setLanguage(_,w);var N=p.textContent,T={element:p,language:w,grammar:b,code:N};function F(oe){T.highlightedCode=oe,i.hooks.run("before-insert",T),T.element.innerHTML=T.highlightedCode,i.hooks.run("after-highlight",T),i.hooks.run("complete",T),h&&h.call(T.element)}if(i.hooks.run("before-sanity-check",T),_=T.element.parentElement,_&&_.nodeName.toLowerCase()==="pre"&&!_.hasAttribute("tabindex")&&_.setAttribute("tabindex","0"),!T.code){i.hooks.run("complete",T),h&&h.call(T.element);return}if(i.hooks.run("before-highlight",T),!T.grammar){F(i.util.encode(T.code));return}if(g&&r.Worker){var $=new Worker(i.filename);$.onmessage=function(oe){F(oe.data)},$.postMessage(JSON.stringify({language:T.language,code:T.code,immediateClose:!0}))}else F(i.highlight(T.code,T.grammar,T.language))},highlight:function(p,g,h){var w={code:p,grammar:g,language:h};if(i.hooks.run("before-tokenize",w),!w.grammar)throw new Error('The language "'+w.language+'" has no grammar.');return w.tokens=i.tokenize(w.code,w.grammar),i.hooks.run("after-tokenize",w),c.stringify(i.util.encode(w.tokens),w.language)},tokenize:function(p,g){var h=g.rest;if(h){for(var w in h)g[w]=h[w];delete g.rest}var b=new u;return m(b,b.head,p),l(p,b,g,b.head,0),v(b)},hooks:{all:{},add:function(p,g){var h=i.hooks.all;h[p]=h[p]||[],h[p].push(g)},run:function(p,g){var h=i.hooks.all[p];if(!(!h||!h.length))for(var w=0,b;b=h[w++];)b(g)}},Token:c};r.Prism=i;function c(p,g,h,w){this.type=p,this.content=g,this.alias=h,this.length=(w||"").length|0}c.stringify=function p(g,h){if(typeof g=="string")return g;if(Array.isArray(g)){var w="";return g.forEach(function(F){w+=p(F,h)}),w}var b={type:g.type,content:p(g.content,h),tag:"span",classes:["token",g.type],attributes:{},language:h},_=g.alias;_&&(Array.isArray(_)?Array.prototype.push.apply(b.classes,_):b.classes.push(_)),i.hooks.run("wrap",b);var N="";for(var T in b.attributes)N+=" "+T+'="'+(b.attributes[T]||"").replace(/"/g,"&quot;")+'"';return"<"+b.tag+' class="'+b.classes.join(" ")+'"'+N+">"+b.content+"</"+b.tag+">"};function d(p,g,h,w){p.lastIndex=g;var b=p.exec(h);if(b&&w&&b[1]){var _=b[1].length;b.index+=_,b[0]=b[0].slice(_)}return b}function l(p,g,h,w,b,_){for(var N in h)if(!(!h.hasOwnProperty(N)||!h[N])){var T=h[N];T=Array.isArray(T)?T:[T];for(var F=0;F<T.length;++F){if(_&&_.cause==N+","+F)return;var $=T[F],oe=$.inside,Le=!!$.lookbehind,Ce=!!$.greedy,ce=$.alias;if(Ce&&!$.pattern.global){var je=$.pattern.toString().match(/[imsuy]*$/)[0];$.pattern=RegExp($.pattern.source,je+"g")}for(var Re=$.pattern||$,H=w.next,G=b;H!==g.tail&&!(_&&G>=_.reach);G+=H.value.length,H=H.next){var le=H.value;if(g.length>p.length)return;if(!(le instanceof c)){var ge=1,X;if(Ce){if(X=d(Re,G,p,Le),!X||X.index>=p.length)break;var he=X.index,xe=X.index+X[0].length,q=G;for(q+=H.value.length;he>=q;)H=H.next,q+=H.value.length;if(q-=H.value.length,G=q,H.value instanceof c)continue;for(var pe=H;pe!==g.tail&&(q<xe||typeof pe.value=="string");pe=pe.next)ge++,q+=pe.value.length;ge--,le=p.slice(G,q),X.index-=G}else if(X=d(Re,0,le,Le),!X)continue;var he=X.index,ne=X[0],Q=le.slice(0,he),de=le.slice(he+ne.length),f=G+le.length;_&&f>_.reach&&(_.reach=f);var E=H.prev;Q&&(E=m(g,E,Q),G+=Q.length),y(g,E,ge);var A=new c(N,oe?i.tokenize(ne,oe):ne,ce,ne);if(H=m(g,E,A),de&&m(g,H,de),ge>1){var P={cause:N+","+F,reach:f};l(p,g,h,H.prev,G,P),_&&P.reach>_.reach&&(_.reach=P.reach)}}}}}}function u(){var p={value:null,prev:null,next:null},g={value:null,prev:p,next:null};p.next=g,this.head=p,this.tail=g,this.length=0}function m(p,g,h){var w=g.next,b={value:h,prev:g,next:w};return g.next=b,w.prev=b,p.length++,b}function y(p,g,h){for(var w=g.next,b=0;b<h&&w!==p.tail;b++)w=w.next;g.next=w,w.prev=g,p.length-=b}function v(p){for(var g=[],h=p.head.next;h!==p.tail;)g.push(h.value),h=h.next;return g}if(!r.document)return r.addEventListener&&(i.disableWorkerMessageHandler||r.addEventListener("message",function(p){var g=JSON.parse(p.data),h=g.language,w=g.code,b=g.immediateClose;r.postMessage(i.highlight(w,i.languages[h],h)),b&&r.close()},!1)),i;var S=i.util.currentScript();S&&(i.filename=S.src,S.hasAttribute("data-manual")&&(i.manual=!0));function x(){i.manual||i.highlightAll()}if(!i.manual){var I=document.readyState;I==="loading"||I==="interactive"&&S&&S.defer?document.addEventListener("DOMContentLoaded",x):window.requestAnimationFrame?window.requestAnimationFrame(x):window.setTimeout(x,16)}return i})(t);e.exports&&(e.exports=n),typeof ht<"u"&&(ht.Prism=n),n.languages.markup={comment:{pattern:/\x3C!--(?:(?!\x3C!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|\x3C!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,a){var o={};o["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[a]},o.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:o}};i["language-"+a]={pattern:/[\s\S]+/,inside:n.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:i},n.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,(function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var a=r.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,(function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading…",s=function(S,x){return"✖ Error "+S+" while fetching file: "+x},a="✖ Error: File does not exist or is empty",o={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},i="data-src-status",c="loading",d="loaded",l="failed",u="pre[data-src]:not(["+i+'="'+d+'"]):not(['+i+'="'+c+'"])';function m(S,x,I){var p=new XMLHttpRequest;p.open("GET",S,!0),p.onreadystatechange=function(){p.readyState==4&&(p.status<400&&p.responseText?x(p.responseText):p.status>=400?I(s(p.status,p.statusText)):I(a))},p.send(null)}function y(S){var x=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(S||"");if(x){var I=Number(x[1]),p=x[2],g=x[3];return p?g?[I,Number(g)]:[I,void 0]:[I,I]}}n.hooks.add("before-highlightall",function(S){S.selector+=", "+u}),n.hooks.add("before-sanity-check",function(S){var x=S.element;if(x.matches(u)){S.code="",x.setAttribute(i,c);var I=x.appendChild(document.createElement("CODE"));I.textContent=r;var p=x.getAttribute("data-src"),g=S.language;if(g==="none"){var h=(/\.(\w+)$/.exec(p)||[,"none"])[1];g=o[h]||h}n.util.setLanguage(I,g),n.util.setLanguage(x,g);var w=n.plugins.autoloader;w&&w.loadLanguages(g),m(p,function(b){x.setAttribute(i,d);var _=y(x.getAttribute("data-range"));if(_){var N=b.split(/\r\n?|\n/g),T=_[0],F=_[1]==null?N.length:_[1];T<0&&(T+=N.length),T=Math.max(0,Math.min(T-1,N.length)),F<0&&(F+=N.length),F=Math.max(0,Math.min(F,N.length)),b=N.slice(T,F).join(`
`),x.hasAttribute("data-start")||x.setAttribute("data-start",String(T+1))}I.textContent=b,n.highlightElement(I)},function(b){x.setAttribute(i,l),I.textContent=b})}}),n.plugins.fileHighlight={highlight:function(x){for(var I=(x||document).querySelectorAll(u),p=0,g;g=I[p++];)n.highlightElement(g)}};var v=!1;n.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(ze)),ze.exports}var Ir=Pr();const Ye=_r(Ir);let fe=null;const Lt="memimg-line-numbers";let Je=null;function Nr(e){Je=e}function Ct(e){fe&&fe.updateCode(e)}function Rt(){const e=localStorage.getItem(Lt);return e===null?!0:e==="true"}function Lr(e){localStorage.setItem(Lt,e.toString())}function at(){const e=document.getElementById("line-numbers"),t=document.getElementById("code-editor");if(!fe||!e)return;const s=fe.toString().split(`
`).length,a=Array.from({length:s},(o,i)=>i+1).join(`
`);e.textContent=a,t.addEventListener("scroll",()=>{e.scrollTop=t.scrollTop})}function Cr(){const e=document.getElementById("line-numbers"),n=!Rt();Lr(n),e&&(e.style.display=n?"block":"none"),n&&at()}function Rr(){const e=document.getElementById("line-numbers"),t=Rt();e&&(e.style.display=t?"block":"none"),t&&at()}function qe(e,t=""){const n=document.getElementById("status");n.textContent=e,n.className=t,e&&t!=="error"&&setTimeout(()=>{n.textContent="",n.className=""},3e3)}async function kt(e,t,n,r){var i,c;if(!fe)return;const s=fe.toString().trim();if(!s)return;let a;try{a=new Function(s)}catch(d){const l=d;let u=l.message;const m=u.match(/\((\d+):(\d+)\)/),y=u.match(/line (\d+)/);let v,S;if(m?(v=parseInt(m[1]),S=parseInt(m[2]),u=`Line ${v}, Col ${S}: ${l.message}`):y&&(v=parseInt(y[1]),u=`Line ${v}: ${l.message}`),v!==void 0){const I=s.split(`
`),p=v-1;p>=0&&p<I.length&&(u+=`

`+I[p])}const x=document.getElementById("error-panel");x.textContent=u,x.style.display="block",qe("Syntax error - see below editor","error"),console.error("Syntax error:",l),console.error("Message:",l.message);return}const o=t.createCheckpoint();try{const d=a.call(e);d!==void 0&&console.log("Result:",d);const l=document.getElementById("error-panel");if(l.textContent="",l.style.display="none",n)try{await wr(n,s),Je&&(await new Promise(u=>setTimeout(u,50)),await Je())}catch(u){console.error("Failed to save script to history:",u)}fe.updateCode(""),qe("Code executed","success"),r&&r()}catch(d){t.restoreCheckpoint(o);const l=d;let u=l.message;const m=(i=l.stack)==null?void 0:i.match(/<anonymous>:(\d+):(\d+)/),y=(c=l.stack)==null?void 0:c.match(/Function:(\d+):(\d+)/),v=m||y;if(v){const x=parseInt(v[1]),I=parseInt(v[2]),p=x-2;u=`Line ${p}, Col ${I}: ${l.message}`;const g=s.split(`
`),h=p-1;h>=0&&h<g.length&&(console.error("Error at line",p,":",g[h]),u+=`

`+g[h])}const S=document.getElementById("error-panel");S.textContent=u,S.style.display="block",qe("Runtime error - changes rolled back","error"),console.error("Runtime error:",l),console.error("Stack:",l.stack),console.log("Delta restored to checkpoint (partial mutations discarded)")}}let ve=null;function kr(e,t,n,r){const s=document.getElementById("code-editor");ve={root:e,txn:t,memimgId:n,onExecute:r},fe||(fe=Tr(s,o=>{const i=o.textContent||"";Ye.languages.javascript&&(o.innerHTML=Ye.highlight(i,Ye.languages.javascript,"javascript")),at()},{tab:"  ",indentOn:/[(\[{]$/}),Rr(),s.addEventListener("keydown",async o=>{o.ctrlKey&&o.key==="Enter"&&(o.preventDefault(),ve&&await kt(ve.root,ve.txn,ve.memimgId,ve.onExecute))}))}const De="memimg-explorer",z="memimg-metadata";function Dr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}async function we(){return new Promise((e,t)=>{const n=indexedDB.open(De);n.onerror=()=>{t(n.error)},n.onsuccess=async()=>{const r=n.result,s=r.version,a=!r.objectStoreNames.contains(z);if(r.close(),await new Promise(o=>setTimeout(o,50)),a){const o=indexedDB.open(De,s+1);o.onerror=()=>{t(o.error)},o.onblocked=()=>{},o.onsuccess=()=>{e(o.result)},o.onupgradeneeded=i=>{const c=i.target.result;if(!c.objectStoreNames.contains(z)){const d=c.createObjectStore(z,{keyPath:"id"});d.createIndex("createdAt","createdAt",{unique:!1}),d.createIndex("updatedAt","updatedAt",{unique:!1})}}}else{const o=indexedDB.open(De);o.onblocked=()=>{},o.onerror=()=>{t(o.error)},o.onsuccess=()=>{e(o.result)}}},n.onupgradeneeded=r=>{const s=r.target.result;if(!s.objectStoreNames.contains(z)){const a=s.createObjectStore(z,{keyPath:"id"});a.createIndex("createdAt","createdAt",{unique:!1}),a.createIndex("updatedAt","updatedAt",{unique:!1})}}})}async function Dt(){const e=await we();return new Promise((t,n)=>{const o=e.transaction([z],"readonly").objectStore(z).index("updatedAt").openCursor(null,"prev"),i=[];o.onsuccess=async()=>{const c=o.result;c?(i.push(c.value),c.continue()):(e.close(),await new Promise(d=>setTimeout(d,50)),t(i))},o.onerror=async()=>{e.close(),await new Promise(c=>setTimeout(c,50)),n(o.error)}})}async function Or(e){const t=await we();return new Promise((n,r)=>{const o=t.transaction([z],"readonly").objectStore(z).get(e);o.onsuccess=async()=>{t.close(),await new Promise(i=>setTimeout(i,50)),n(o.result||null)},o.onerror=async()=>{t.close(),await new Promise(i=>setTimeout(i,50)),r(o.error)}})}async function Ot(e,t){const n=await Dt(),r=e.trim().toLowerCase();return n.some(a=>a.id!==t&&a.name.toLowerCase()===r)}async function Fr(e,t=""){if(!e||e.trim().length===0)throw new Error("Memory image name cannot be empty");if(await Ot(e))throw new Error("A memory image with this name already exists");const n={id:Dr(),name:e.trim(),description:t.trim(),createdAt:Date.now(),updatedAt:Date.now(),eventCount:0},r=await we();return new Promise((s,a)=>{const c=r.transaction([z],"readwrite").objectStore(z).add(n);c.onsuccess=async()=>{r.close(),await new Promise(d=>setTimeout(d,50)),s(n)},c.onerror=async()=>{r.close(),await new Promise(d=>setTimeout(d,50)),a(c.error)}})}async function Mr(e,t){if(!t||t.trim().length===0)throw new Error("Memory image name cannot be empty");if(await Ot(t,e))throw new Error("A memory image with this name already exists");const n=await we();return new Promise((r,s)=>{const o=n.transaction([z],"readwrite").objectStore(z),i=o.get(e);i.onsuccess=async()=>{const c=i.result;if(!c){n.close(),await new Promise(l=>setTimeout(l,50)),s(new Error(`Memory image not found: ${e}`));return}c.name=t.trim(),c.updatedAt=Date.now();const d=o.put(c);d.onsuccess=async()=>{n.close(),await new Promise(l=>setTimeout(l,50)),r()},d.onerror=async()=>{n.close(),await new Promise(l=>setTimeout(l,50)),s(d.error)}},i.onerror=async()=>{n.close(),await new Promise(c=>setTimeout(c,50)),s(i.error)}})}async function Br(e,t){const n=await we();return new Promise((r,s)=>{const o=n.transaction([z],"readwrite").objectStore(z),i=o.get(e);i.onsuccess=async()=>{const c=i.result;if(!c){n.close(),await new Promise(l=>setTimeout(l,50)),s(new Error(`Memory image not found: ${e}`));return}c.description=t.trim(),c.updatedAt=Date.now();const d=o.put(c);d.onsuccess=async()=>{n.close(),await new Promise(l=>setTimeout(l,50)),r()},d.onerror=async()=>{n.close(),await new Promise(l=>setTimeout(l,50)),s(d.error)}},i.onerror=async()=>{n.close(),await new Promise(c=>setTimeout(c,50)),s(i.error)}})}async function $r(e){const t=await we();return new Promise((n,r)=>{const a=t.transaction([z],"readwrite").objectStore(z),o=a.get(e);o.onsuccess=async()=>{const i=o.result;if(!i){t.close(),await new Promise(d=>setTimeout(d,50)),r(new Error(`Memory image not found: ${e}`));return}i.updatedAt=Date.now();const c=a.put(i);c.onsuccess=async()=>{t.close(),await new Promise(d=>setTimeout(d,50)),n()},c.onerror=async()=>{t.close(),await new Promise(d=>setTimeout(d,50)),r(c.error)}},o.onerror=async()=>{t.close(),await new Promise(i=>setTimeout(i,50)),r(o.error)}})}async function Hr(e){const t=await we();return new Promise((n,r)=>{const o=t.transaction([z],"readwrite").objectStore(z).delete(e);o.onsuccess=async()=>{const i=`events-${e}`,c=ot(e);try{const d=t.objectStoreNames.contains(i),l=t.objectStoreNames.contains(c);if(d||l){t.close(),await new Promise(y=>setTimeout(y,50));const u=t.version,m=indexedDB.open(De,u+1);m.onupgradeneeded=y=>{const v=y.target.result;v.objectStoreNames.contains(i)&&v.deleteObjectStore(i),v.objectStoreNames.contains(c)&&v.deleteObjectStore(c)},m.onsuccess=async()=>{m.result.close(),await new Promise(y=>setTimeout(y,50)),n()},m.onerror=()=>{r(m.error)}}else t.close(),await new Promise(u=>setTimeout(u,50)),n()}catch(d){t.close(),await new Promise(l=>setTimeout(l,50)),r(d)}},o.onerror=async()=>{t.close(),await new Promise(i=>setTimeout(i,50)),r(o.error)}})}function Ur(e){return`events-${e}`}function Et(e){const t=new Date(e),r=new Date().getTime()-t.getTime(),s=Math.floor(r/6e4),a=Math.floor(r/36e5),o=Math.floor(r/864e5);return s<1?"Just now":s<60?`${s}m ago`:a<24?`${a}h ago`:o<7?`${o}d ago`:t.toLocaleDateString()}async function He(e,t){try{const n=await Dt();if(n.length===0){e.innerHTML=`
        <div class="empty-state">
          <div class="empty-icon">📦</div>
          <h2>No Memory Images Yet</h2>
          <p>Create your first memory image to get started</p>
          <button id="create-first-btn" class="primary-button">+ New Memory Image</button>
        </div>
      `,e.querySelector("#create-first-btn").addEventListener("click",()=>Ft(e,t));return}const r=`
      <div class="memimg-grid">
        ${n.map(s=>jr(s,t)).join("")}
      </div>
    `;e.innerHTML=r,n.forEach(s=>{const a=e.querySelector(`[data-id="${s.id}"]`);a.querySelector(".open-btn").addEventListener("click",l=>{l.stopPropagation(),t(s.id)}),a.querySelector(".rename-btn").addEventListener("click",l=>{l.stopPropagation(),zr(s,e,t)}),a.querySelector(".edit-desc-btn").addEventListener("click",l=>{l.stopPropagation(),Yr(s,e,t)}),a.querySelector(".delete-btn").addEventListener("click",async l=>{if(l.stopPropagation(),confirm(`Delete "${s.name}"? This cannot be undone.`))try{await Hr(s.id),await new Promise(u=>setTimeout(u,50)),await He(e,t)}catch(u){alert(`Error deleting memory image: ${u.message}`)}}),a.addEventListener("click",()=>t(s.id))})}catch(n){e.innerHTML=`
      <div class="error-state">
        <h2>Error Loading Memory Images</h2>
        <p>${n.message}</p>
      </div>
    `}}function jr(e,t){const n=e.eventCount!==void 0?`${e.eventCount} events`:"Unknown size";return`
    <div class="memimg-card" data-id="${e.id}">
      <div class="card-header">
        <h3 class="card-title">${Me(e.name)}</h3>
        <div class="card-actions">
          <button class="icon-btn rename-btn" title="Rename">✏️</button>
          <button class="icon-btn edit-desc-btn" title="Edit description">📝</button>
          <button class="icon-btn delete-btn" title="Delete">🗑️</button>
        </div>
      </div>
      <div class="card-body">
        <p class="card-description">${Me(e.description)||"<em>No description</em>"}</p>
        <div class="card-meta">
          <span class="meta-item">📅 Created ${Et(e.createdAt)}</span>
          <span class="meta-item">🕒 Updated ${Et(e.updatedAt)}</span>
          <span class="meta-item">📊 ${n}</span>
        </div>
      </div>
      <div class="card-footer">
        <button class="open-btn">Open →</button>
      </div>
    </div>
  `}function Ft(e,t){const n=document.createElement("div");n.className="modal-overlay",n.innerHTML=`
    <div class="modal-dialog">
      <div class="modal-header">
        <h2>New Memory Image</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="memimg-name">Name *</label>
          <input type="text" id="memimg-name" class="form-input" placeholder="My Memory Image" required autofocus>
        </div>
        <div class="form-group">
          <label for="memimg-desc">Description</label>
          <textarea id="memimg-desc" class="form-textarea" placeholder="Optional description" rows="3"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="cancel-btn">Cancel</button>
        <button class="create-btn primary-button">Create</button>
      </div>
    </div>
  `,document.body.appendChild(n);const r=n.querySelector("#memimg-name"),s=n.querySelector("#memimg-desc"),a=n.querySelector(".modal-close"),o=n.querySelector(".cancel-btn"),i=n.querySelector(".create-btn"),c=()=>{n.remove()},d=async()=>{const l=r.value.trim();if(!l){alert("Please enter a name"),r.focus();return}i.disabled=!0;const u=i.textContent;i.textContent="Creating...";try{console.log("Creating memory image:",l);const m=await Fr(l,s.value.trim());console.log("Memory image created:",m),c(),t(m.id)}catch(m){console.error("Error creating memory image:",m),alert(`Error creating memory image: ${m.message}`),i.disabled=!1,i.textContent=u,r.focus()}};a.addEventListener("click",c),o.addEventListener("click",c),i.addEventListener("click",d),r.addEventListener("keydown",l=>{l.key==="Enter"&&(l.preventDefault(),d())}),n.addEventListener("keydown",l=>{l.key==="Escape"&&c()}),n.addEventListener("click",l=>{l.target===n&&c()}),r.focus()}function zr(e,t,n){const r=document.createElement("div");r.className="modal-overlay",r.innerHTML=`
    <div class="modal-dialog">
      <div class="modal-header">
        <h2>Rename Memory Image</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="memimg-name">Name *</label>
          <input type="text" id="memimg-name" class="form-input" value="${Me(e.name)}" required autofocus>
        </div>
      </div>
      <div class="modal-footer">
        <button class="cancel-btn">Cancel</button>
        <button class="save-btn primary-button">Save</button>
      </div>
    </div>
  `,document.body.appendChild(r);const s=r.querySelector("#memimg-name"),a=r.querySelector(".modal-close"),o=r.querySelector(".cancel-btn"),i=r.querySelector(".save-btn"),c=()=>{r.remove()},d=async()=>{const l=s.value.trim();if(!l){alert("Please enter a name"),s.focus();return}try{await Mr(e.id,l),c(),await He(t,n)}catch(u){alert(`Error renaming: ${u.message}`)}};a.addEventListener("click",c),o.addEventListener("click",c),i.addEventListener("click",d),s.addEventListener("keydown",l=>{l.key==="Enter"&&(l.preventDefault(),d())}),r.addEventListener("keydown",l=>{l.key==="Escape"&&c()}),r.addEventListener("click",l=>{l.target===r&&c()}),s.select()}function Yr(e,t,n){const r=document.createElement("div");r.className="modal-overlay",r.innerHTML=`
    <div class="modal-dialog">
      <div class="modal-header">
        <h2>Edit Description</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="memimg-desc">Description</label>
          <textarea id="memimg-desc" class="form-textarea" rows="4" autofocus>${Me(e.description)}</textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="cancel-btn">Cancel</button>
        <button class="save-btn primary-button">Save</button>
      </div>
    </div>
  `,document.body.appendChild(r);const s=r.querySelector("#memimg-desc"),a=r.querySelector(".modal-close"),o=r.querySelector(".cancel-btn"),i=r.querySelector(".save-btn"),c=()=>{r.remove()},d=async()=>{try{await Br(e.id,s.value.trim()),c(),await He(t,n)}catch(l){alert(`Error updating description: ${l.message}`)}};a.addEventListener("click",c),o.addEventListener("click",c),i.addEventListener("click",d),r.addEventListener("keydown",l=>{l.key==="Escape"&&c()}),r.addEventListener("click",l=>{l.target===r&&c()}),s.focus()}function Me(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}const Mt=50;function qr(e){const n=Date.now()-e,r=Math.floor(n/1e3),s=Math.floor(r/60),a=Math.floor(s/60),o=Math.floor(a/24);return r<60?"just now":s<60?`${s} min${s>1?"s":""} ago`:a<24?`${a} hour${a>1?"s":""} ago`:`${o} day${o>1?"s":""} ago`}function Wr(e){return new Date(e).toLocaleString()}function wt(e,t=Mt){return e.length<=t?e:e.substring(0,t)+"..."}function We(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function Bt(e,t,n){const r=document.createElement("div");r.className="history-entry",r.dataset.entryId=e.id;const s=e.code.length>Mt,a=wt(e.code);r.innerHTML=`
    <div class="history-entry-header">
      <span class="history-status">●</span>
      <span class="history-timestamp" title="${We(Wr(e.timestamp))}">
        ${We(qr(e.timestamp))}
      </span>
      <span class="history-size">${e.characterCount} chars</span>
    </div>
    <div class="history-code ${s?"expandable":""}" data-expanded="false">
      <pre>${We(a)}</pre>
    </div>
    <div class="history-actions">
      <button class="history-btn load-btn" title="Load into editor">⬆ Load</button>
      <button class="history-btn copy-btn" title="Copy to clipboard">📋 Copy</button>
      ${s?'<button class="history-btn expand-btn" title="Expand/collapse">▼ Expand</button>':""}
    </div>
  `;const o=r.querySelector(".load-btn"),i=r.querySelector(".copy-btn"),c=r.querySelector(".expand-btn"),d=r.querySelector(".history-code");return o==null||o.addEventListener("click",l=>{l.stopPropagation(),t(e.code)}),i==null||i.addEventListener("click",async l=>{l.stopPropagation(),n(e.code)}),c&&s&&c.addEventListener("click",l=>{l.stopPropagation(),d.dataset.expanded==="true"?(d.querySelector("pre").textContent=wt(e.code),d.dataset.expanded="false",c.textContent="▼ Expand"):(d.querySelector("pre").textContent=e.code,d.dataset.expanded="true",c.textContent="▲ Collapse")}),r}async function Xe(e,t,n){try{const r=await $e(t,100);if(e.innerHTML="",r.length===0){e.innerHTML='<div class="history-empty">No script history yet. Run a script to get started.</div>';return}for(const o of r){const i=Bt(o,n,async c=>{try{await navigator.clipboard.writeText(c);const d=e.querySelector(`[data-entry-id="${o.id}"] .copy-btn`);if(d){const l=d.textContent;d.textContent="✓ Copied",setTimeout(()=>{d.textContent=l},1e3)}}catch(d){console.error("Failed to copy:",d),alert("Failed to copy to clipboard")}});e.appendChild(i)}const s=await xr(t),a=document.querySelector(".history-stats");if(a){const o=(s.totalSize/1048576).toFixed(2);a.textContent=`${s.count} entries, ${o} MB`}}catch(r){console.error("Failed to render script history:",r),e.innerHTML='<div class="history-error">Failed to load script history</div>'}}function Vr(e,t,n,r){let s=null;e.addEventListener("input",()=>{s&&clearTimeout(s),s=window.setTimeout(async()=>{const a=e.value.trim();try{const o=a?await br(n,a):await $e(n,100);if(t.innerHTML="",o.length===0){t.innerHTML='<div class="history-empty">No matching scripts found.</div>';return}for(const i of o){const c=Bt(i,r,async d=>{try{await navigator.clipboard.writeText(d);const l=t.querySelector(`[data-entry-id="${i.id}"] .copy-btn`);if(l){const u=l.textContent;l.textContent="✓ Copied",setTimeout(()=>{l.textContent=u},1e3)}}catch(l){console.error("Failed to copy:",l),alert("Failed to copy to clipboard")}});t.appendChild(c)}}catch(o){console.error("Search failed:",o),t.innerHTML='<div class="history-error">Search failed</div>'}},300)})}function Gr(e,t,n){e.addEventListener("click",async()=>{if(confirm("Clear all script history? This cannot be undone."))try{await vr(t),n()}catch(r){console.error("Failed to clear history:",r),alert("Failed to clear history")}})}function Kr(e,t,n){e.addEventListener("click",async()=>{try{const r=await Sr(t),s=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a;const i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);o.download=`${n}-script-history-${i}.json`,o.click(),URL.revokeObjectURL(a)}catch(r){console.error("Failed to export history:",r),alert("Failed to export history")}})}let j=null,ie=null,R=null,B=null,O;const ee=new Pn;function it(e){window.location.hash=e}function $t(){const e=window.location.hash.slice(1);if(!e||e==="/")return{view:"list"};const t=e.match(/^\/edit\/(.+)$/);return t?{view:"edit",memimgId:t[1]}:{view:"list"}}async function Jr(){const e=$t();if(e.view==="list")j&&await Yt();else if(e.view==="edit"&&e.memimgId&&j!==e.memimgId)try{await Ue(e.memimgId)}catch(t){console.error(`Failed to open memory image from hash: ${e.memimgId}`,t),C(`Memory image not found: ${e.memimgId}`,"error"),it("/")}}const Ht=document.getElementById("list-view"),Ut=document.getElementById("explorer-view"),jt=document.getElementById("memimg-list-content");window.viewAsJson=function(e,t=!0){const n=JSON.parse(xt(e,new WeakMap)),r=t?JSON.stringify(n,null,2):JSON.stringify(n);return console.log(r),n};function C(e,t=""){const n=document.getElementById("status");n&&(n.textContent=e,n.className="status-bar "+t,e&&t!=="error"&&setTimeout(()=>{n.textContent="",n.className="status-bar"},3e3))}function be(){const e=R?R.isDirty():!1,t=document.getElementById("save-btn"),n=document.getElementById("discard-btn");!t||!n||(e?(t.classList.add("dirty"),n.style.display="inline-block"):(t.classList.remove("dirty"),n.style.display="none"))}function re(){B&&(Un(B,ee,document.getElementById("tree-view"),re),gr(B,ee,document.getElementById("inspector-view"),re),Xr(),be())}function Xr(){const e=document.getElementById("back-btn"),t=document.getElementById("forward-btn");!e||!t||(e.disabled=!ee.canGoBack(),t.disabled=!ee.canGoForward())}async function Zr(){if(!B){C("No memory image open","error");return}try{const e=window.ObjectType,t=window.NumberType,n=window.StringType,r=window.DateTypeInstance;if(!e)throw new Error("ObjectType not found - javascript-types library not loaded");const s=e({name:"Name",properties:{firstName:{type:n},middleName:{type:n},lastName:{type:n}}}),a=e({name:"Dept",properties:{deptno:{type:t},dname:{type:n},loc:{type:n},emps:{type:null}}}),o=e({name:"Emp",properties:{empno:{type:t},ename:{type:s},job:{type:n},mgr:{type:null},hiredate:{type:r},sal:{type:t},comm:{type:t},dept:{type:a},subordinates:{type:null}}}),i=a({deptno:10,dname:"ACCOUNTING",loc:"NEW YORK"}),c=a({deptno:20,dname:"RESEARCH",loc:"DALLAS"}),d=a({deptno:30,dname:"SALES",loc:"CHICAGO"}),l=a({deptno:40,dname:"OPERATIONS",loc:"BOSTON"}),u=o({empno:7839,ename:s({firstName:"Arthur",middleName:"Rex",lastName:"KING"}),job:"PRESIDENT",mgr:null,hiredate:new Date("1981-11-17"),sal:5e3,comm:null,dept:i,subordinates:[]}),m=o({empno:7566,ename:s({firstName:"Indiana",middleName:"Henry",lastName:"JONES"}),job:"MANAGER",mgr:u,hiredate:new Date("1981-04-02"),sal:2975,comm:null,dept:c,subordinates:[]}),y=o({empno:7698,ename:s({firstName:"William",middleName:"Arthur",lastName:"BLAKE"}),job:"MANAGER",mgr:u,hiredate:new Date("1981-05-01"),sal:2850,comm:null,dept:d,subordinates:[]}),v=o({empno:7369,ename:s({firstName:"John",middleName:"Paul",lastName:"SMITH"}),job:"CLERK",mgr:m,hiredate:new Date("1980-12-17"),sal:800,comm:null,dept:c,subordinates:[]}),S=o({empno:7499,ename:s({firstName:"Ethan",middleName:"James",lastName:"ALLEN"}),job:"SALESMAN",mgr:y,hiredate:new Date("1981-02-20"),sal:1600,comm:300,dept:d,subordinates:[]}),x=o({empno:7521,ename:s({firstName:"Christopher",middleName:"Lee",lastName:"WARD"}),job:"SALESMAN",mgr:y,hiredate:new Date("1981-02-22"),sal:1250,comm:500,dept:d,subordinates:[]});i.emps=[u],c.emps=[m,v],d.emps=[y,S,x],l.emps=[],u.subordinates=[m,y],m.subordinates=[v],y.subordinates=[S,x],v.subordinates=[],S.subordinates=[],x.subordinates=[],B.depts={accounting:i,research:c,sales:d,operations:l},B.emps={king:u,jones:m,blake:y,smith:v,allen:S,ward:x},window.types={Dept:a,Emp:o,Name:s},console.log("Types available at: window.types = { Dept, Emp, Name }"),C("Scott schema loaded (with ObjectType)","success"),be(),await re()}catch(e){const t=e;C("Error loading Scott: "+t.message,"error"),console.error(t)}}async function Qr(){if(!R){C("Transaction not initialized","error");return}if(!R.isDirty()){C("No changes to save","success");return}try{console.log("Committing transaction to IndexedDB..."),await R.save(),j&&await $r(j),be(),C("Changes saved to IndexedDB","success"),await re()}catch(e){const t=e;C("Save error: "+t.message,"error"),console.error(t)}}async function es(){if(!R){C("Transaction not initialized","error");return}if(R.isDirty()&&confirm("Discard all unsaved changes?"))try{console.log("Rolling back transaction..."),R.discard(),be(),C("Changes discarded","success"),await re()}catch(e){C("Discard error: "+e.message,"error"),console.error(e)}}async function ts(){if(confirm("Clear all data from memory image and IndexedDB?")){if(!O||!R){C("Not initialized","error");return}try{for(const e in B)delete B[e];await R.save(),O!=null&&O.clear&&await O.clear(),R=await Qe(O),B=R.root,window.root=B,rt(R.unwrap.bind(R)),ee.reset(),be(),C("Cleared all data","success"),await re()}catch(e){const t=e;C("Clear error: "+t.message,"error"),console.error(t)}}}function zt(e,t){const n=new Blob([t],{type:"text/plain"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=e,s.click(),URL.revokeObjectURL(r)}async function ns(){if(!B){C("No memory image open","error");return}if(!ie){C("No metadata available","error");return}if(!confirm(`📸 Export Snapshot (External Use Only)

⚠️  IMPORTANT: Snapshots CANNOT be re-imported into Filer.

Snapshots are for:
• Sharing data with external tools
• Data analysis and reporting
• Human-readable backups

To save your work for later:
✅ Use 'Export Event Log' instead (re-importable)

Continue with snapshot export?`)){C("Snapshot export cancelled","info");return}try{console.log("Exporting snapshot...");const t=(d,l=new WeakSet)=>{if(d==null||typeof d!="object"||l.has(d))return d;l.add(d);const u=R.unwrap(d);if(u instanceof Date)return u;if(Array.isArray(u))return u.map(y=>t(y,l));if(u instanceof Map){const y=new Map;return u.forEach((v,S)=>{y.set(t(S,l),t(v,l))}),y}if(u instanceof Set){const y=new Set;return u.forEach(v=>{y.add(t(v,l))}),y}const m={};for(const y in u)Object.prototype.hasOwnProperty.call(u,y)&&(m[y]=t(u[y],l));return m},n=t(B),r=xt(n,new WeakMap),s=JSON.parse(r),a={type:"snapshot",version:1,timestamp:Date.now(),name:ie.name,description:ie.description,state:s},o=JSON.stringify(a,null,2),i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5),c=`${ie.name}-snapshot-${i}.json`;zt(c,o),C(`Exported snapshot to ${c}`,"success"),console.log(`Exported snapshot (${o.length} bytes)`)}catch(t){const n=t;C("Export error: "+n.message,"error"),console.error("Export error:",n)}}async function rs(){if(!O){C("No memory image open","error");return}if(!ie){C("No metadata available","error");return}try{console.log("Exporting events...");const e=await O.getAll();if(e.length===0){C("No events to export","success");return}const t=e.map(s=>JSON.stringify(s)).join(`
`),n=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5),r=`${ie.name}-${n}.ndjson`;zt(r,t),C(`Exported ${e.length} events to ${r}`,"success"),console.log(`Exported ${e.length} events`)}catch(e){const t=e;C("Export error: "+t.message,"error"),console.error("Export error:",t)}}async function ss(e){if(!O||!R){C("No memory image open","error");return}try{console.log(`Importing event log from ${e.name}...`);const t=await e.text();try{const s=JSON.parse(t);if(s&&typeof s=="object"&&s.type==="snapshot"){C("Snapshot files cannot be imported. Use 'Export Event Log' to create re-importable files.","error"),alert(`⚠️  Snapshot Import Not Supported

Snapshot files are for external consumption only and cannot be re-imported.

To save and restore your data:
• Use 'Export Event Log' (not 'Export Snapshot')
• Event logs can be imported to restore your work

Snapshots are useful for sharing data with other tools,
but only Event Logs preserve the mutation history needed for import.`);return}}catch{}const n=t.trim().split(`
`).filter(s=>s.trim());if(n.length===0){C("No events found in file","error");return}const r=n.map(s=>{try{return JSON.parse(s)}catch{throw new Error(`Invalid JSON in file: ${s.slice(0,50)}...`)}});if(console.log(`Parsed ${r.length} events`),!confirm(`Import ${r.length} events? This will replace all current data.`))return;O!=null&&O.clear&&(await O.clear(),console.log("Cleared existing event log"));for(const s of r)await O.append(s);console.log(`Replayed ${r.length} events`),R=await Qe(O),B=R.root,window.root=B,rt(R.unwrap.bind(R)),ee.reset(),be(),C(`Imported ${r.length} events from ${e.name}`,"success"),await re()}catch(t){const n=t;C("Import error: "+n.message,"error"),console.error("Import error:",n)}}function os(){document.querySelectorAll(".resize-handle").forEach(t=>{let n=0,r=0,s=0,a=null,o=null;t.addEventListener("dblclick",d=>{d.preventDefault();const l=t.dataset.direction,u=t.previousElementSibling,m=t.nextElementSibling;if(!u||!m)return;const y=l==="vertical"?u.offsetHeight+m.offsetHeight:u.offsetWidth+m.offsetWidth,v=Math.floor(y/2);l==="vertical"?(u.style.flex="none",u.style.height=`${v}px`,m.style.flex="none",m.style.height=`${v}px`):(u.style.flex="none",u.style.width=`${v}px`,m.style.flex="none",m.style.width=`${v}px`)}),t.addEventListener("mousedown",d=>{d.preventDefault();const l=t.dataset.direction;a=t.previousElementSibling,o=t.nextElementSibling,!(!a||!o)&&(n=l==="vertical"?d.clientY:d.clientX,r=l==="vertical"?a.offsetHeight:a.offsetWidth,s=l==="vertical"?o.offsetHeight:o.offsetWidth,document.addEventListener("mousemove",i),document.addEventListener("mouseup",c),document.body.style.cursor=l==="vertical"?"ns-resize":"ew-resize",document.body.style.userSelect="none")});function i(d){if(!a||!o||!t)return;const l=t.dataset.direction,m=(l==="vertical"?d.clientY:d.clientX)-n,y=r+m,v=s-m,S=50;y<S||v<S||(l==="vertical"?(a.style.flex="none",a.style.height=`${y}px`,o.style.flex="none",o.style.height=`${v}px`):(a.style.flex="none",a.style.width=`${y}px`,o.style.flex="none",o.style.width=`${v}px`))}function c(){document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",c),document.body.style.cursor="",document.body.style.userSelect=""}})}function as(){if(!j||!ie)return;const e=document.getElementById("history-list"),t=document.getElementById("history-search"),n=document.getElementById("clear-history-btn"),r=document.getElementById("export-history-btn"),s=document.getElementById("toggle-history-btn"),a=document.getElementById("close-history-btn"),o=document.getElementById("script-history-sidebar");if(!e||!t||!n||!r)return;let i=!1;const c=l=>{Ct(l);const u=document.getElementById("code-editor");u&&u.focus(),o&&o.classList.add("collapsed")},d=async()=>{if(!i&&j)try{await Xe(e,j,c),i=!0}catch(l){console.error("Failed to load script history:",l),e.innerHTML='<div class="history-error">Failed to load history</div>'}};Vr(t,e,j,c),Gr(n,j,async()=>{j&&(await Xe(e,j,c),i=!0)}),Kr(r,j,ie.name),s&&o&&(s.onclick=async()=>{const l=o.classList.contains("collapsed");o.classList.toggle("collapsed"),l&&await d()}),a&&o&&(a.onclick=()=>{o.classList.add("collapsed")}),e.innerHTML='<div class="history-empty">Open history panel to view scripts</div>'}async function is(){if(!j)return;const e=document.getElementById("script-history-sidebar"),t=document.getElementById("history-list");if(!e||!t||e.classList.contains("collapsed"))return;await Xe(t,j,r=>{Ct(r);const s=document.getElementById("code-editor");s&&s.focus(),e&&e.classList.add("collapsed")})}async function Ze(){Ut.style.display="none",Ht.style.display="flex",await He(jt,Ue),document.title="Navigator - Memory Image Explorer",it("/"),console.log("Showing list view")}async function Ue(e){j=e;try{console.log(`Opening memory image: ${e}`);const t=await Or(e);if(!t)throw new Error(`Memory image not found: ${e}`);ie=t,await Er(e),console.log("Script history store ensured");const n=Ur(e);O=Zt("memimg-explorer",n),R=await Qe(O),B=R.root,window.root=B,rt(R.unwrap.bind(R)),ee.onNavigate=re;const r=O.append.bind(O);O.append=async function(o){await r(o),be()},Ht.style.display="none",Ut.style.display="flex";const s=document.getElementById("current-memimg-name");s&&(s.textContent=t.name),document.title=`${t.name} - Navigator`;const a=document.getElementById("code-editor");a&&(a.value=""),as(),kr(B,R,j,re),Nr(is),C("Ready","success"),await re(),it(`/edit/${e}`),console.log("Memory image opened successfully")}catch(t){const n=t;C("Error opening memory image: "+n.message,"error"),console.error("Open error:",n)}}async function Yt(){if(R&&R.isDirty()&&!confirm("You have unsaved changes. Close anyway?"))return;const e=document.getElementById("code-editor");e&&(e.value="");const t=document.getElementById("script-history-sidebar");if(t&&t.classList.add("collapsed"),O!=null&&O.close)try{await O.close()}catch{}j=null,ie=null,R=null,B=null,O=void 0,window.root=void 0,ee.reset(),await Ze(),console.log("Memory image closed")}const qt="memimg-theme";function Wt(){return localStorage.getItem(qt)||"dark"}function Vt(e){localStorage.setItem(qt,e),document.documentElement.setAttribute("data-theme",e),cs(e)}function cs(e){const t=e==="dark"?"☀️":"🌙",n=document.getElementById("theme-toggle-list"),r=document.getElementById("theme-toggle-explorer");n&&(n.textContent=t),r&&(r.textContent=t)}function bt(){const t=Wt()==="dark"?"light":"dark";Vt(t)}function ls(){const e=Wt();Vt(e)}let Se=null,te="balanced";function ds(){const e=document.getElementById("editor-panel"),t=document.getElementById("bottom-panels");if(!e||!t)return;te!=="editor-max"&&(Se={editorHeight:e.offsetHeight,graphHeight:t.offsetHeight});const n=e.offsetHeight+t.offsetHeight;e.style.flex="none",e.style.height=`${n-50}px`,t.style.flex="none",t.style.height="50px",te="editor-max",lt()}function us(){const e=document.getElementById("editor-panel"),t=document.getElementById("bottom-panels");if(!e||!t)return;te!=="graph-max"&&(Se={editorHeight:e.offsetHeight,graphHeight:t.offsetHeight});const n=e.offsetHeight+t.offsetHeight;e.style.flex="none",e.style.height="50px",t.style.flex="none",t.style.height=`${n-50}px`,te="graph-max",lt()}function ct(){const e=document.getElementById("editor-panel"),t=document.getElementById("bottom-panels");if(!(!e||!t)){if(Se&&te!=="balanced")e.style.flex="none",e.style.height=`${Se.editorHeight}px`,t.style.flex="none",t.style.height=`${Se.graphHeight}px`,Se=null;else{const n=e.offsetHeight+t.offsetHeight,r=Math.floor(n/2);e.style.flex="none",e.style.height=`${r}px`,t.style.flex="none",t.style.height=`${r}px`}te="balanced",lt()}}function vt(){te==="editor-max"?ct():ds()}function St(){te==="graph-max"?ct():us()}function lt(){const e=document.getElementById("maximize-editor-btn"),t=document.getElementById("maximize-graph-btn");e&&(e.textContent="⛶",e.title=te==="editor-max"?"Restore editor (Alt+E)":"Maximize editor (Alt+E)"),t&&(t.textContent="⛶",t.title=te==="graph-max"?"Restore graph (Alt+G)":"Maximize graph (Alt+G)")}function fs(){const e=document.getElementById("create-memimg-btn");e&&e.addEventListener("click",()=>{Ft(jt,Ue)});const t=document.getElementById("back-to-list-btn");t&&t.addEventListener("click",Yt);const n=document.getElementById("back-btn"),r=document.getElementById("forward-btn");n&&n.addEventListener("click",()=>{ee.goBack()}),r&&r.addEventListener("click",()=>{ee.goForward()}),document.addEventListener("keydown",p=>{p.altKey&&p.key==="ArrowLeft"&&(p.preventDefault(),ee.goBack()),p.altKey&&p.key==="ArrowRight"&&(p.preventDefault(),ee.goForward()),p.altKey&&p.key.toLowerCase()==="e"&&(p.preventDefault(),vt()),p.altKey&&p.key.toLowerCase()==="g"&&(p.preventDefault(),St()),p.altKey&&p.key.toLowerCase()==="b"&&(p.preventDefault(),ct())});const s=document.getElementById("load-scott-btn"),a=document.getElementById("export-snapshot-btn"),o=document.getElementById("export-events-btn"),i=document.getElementById("import-events-btn"),c=document.getElementById("save-btn"),d=document.getElementById("discard-btn"),l=document.getElementById("clear-btn");s&&s.addEventListener("click",Zr),a&&a.addEventListener("click",ns),o&&o.addEventListener("click",rs),i&&i.addEventListener("click",()=>{const p=document.getElementById("events-file-input");p&&p.click()}),c&&c.addEventListener("click",Qr),d&&d.addEventListener("click",es),l&&l.addEventListener("click",ts);const u=document.getElementById("events-file-input");u&&u.addEventListener("change",async p=>{var w;const g=p.target,h=(w=g.files)==null?void 0:w[0];h&&(await ss(h),g.value="")});const m=document.getElementById("run-btn");m&&m.addEventListener("click",async()=>{B&&R&&j&&await kt(B,R,j,re)});const y=document.getElementById("toggle-line-numbers-btn");y&&y.addEventListener("click",Cr);const v=document.getElementById("maximize-editor-btn");v&&v.addEventListener("click",vt);const S=document.getElementById("maximize-graph-btn");S&&S.addEventListener("click",St),window.addEventListener("hashchange",Jr),os();const x=document.getElementById("theme-toggle-list"),I=document.getElementById("theme-toggle-explorer");x&&x.addEventListener("click",bt),I&&I.addEventListener("click",bt),console.log("Event listeners attached")}(async()=>{try{console.log("Initializing Navigator..."),window.addEventListener("pageshow",n=>{if(n.persisted){const r=document.getElementById("code-editor");r&&(r.value="")}});const e=document.getElementById("code-editor");e&&(e.value=""),ls(),fs();const t=$t();if(t.view==="edit"&&t.memimgId){console.log(`Loading memory image from hash: ${t.memimgId}`);try{await Ue(t.memimgId)}catch(n){console.error(`Failed to load memory image from hash: ${t.memimgId}`,n),C(`Could not load memory image: ${t.memimgId}`,"error"),await Ze()}}else await Ze();console.log("Navigator initialization complete")}catch(e){console.error("Failed to initialize:",e),C("Initialization error: "+e.message,"error")}})();</script>
  <link rel="stylesheet" crossorigin href="./navigator.css">
</head>
<body>
    <div id="app">
        <!-- List View (shown by default) -->
        <div id="list-view" class="view-container">
            <div class="app-title">Filer Navigator</div>
            <header class="list-header">
                <div class="logo">
                    <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"
                    width="32" height="32" aria-label="Navigator">
                        <circle cx="24" cy="24" r="22" fill="#6366f1"/>
                        <line x1="24" y1="14" x2="16" y2="24" stroke="#fbbf24" stroke-width="2" stroke-linecap="round"/>
                        <line x1="24" y1="14" x2="32" y2="24" stroke="#fbbf24" stroke-width="2" stroke-linecap="round"/>
                        <line x1="16" y1="24" x2="24" y2="34" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
                        <line x1="32" y1="24" x2="24" y2="34" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
                        <line x1="16" y1="24" x2="32" y2="24" stroke="#ec4899" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="24" cy="14" r="4" fill="#fef3c7"/>
                        <circle cx="16" cy="24" r="4" fill="#fde68a"/>
                        <circle cx="32" cy="24" r="4" fill="#fde68a"/>
                        <circle cx="24" cy="34" r="4" fill="#fef3c7"/>
                        <circle cx="24" cy="24" r="3" fill="#ffffff"/>
                        <text x="24" y="43" font-family="Arial, sans-serif"
                        font-size="5.5" font-weight="bold" fill="#ffffff"
                        text-anchor="middle" letter-spacing="1.5">Navigator</text>
                    </svg>
                    <h1>Navigator</h1>
                    <span class="subtitle">Memory Image Explorer</span>
                </div>
                <div class="controls">
                    <button id="theme-toggle-list" class="icon-btn" title="Toggle theme">🌙</button>
                    <button id="create-memimg-btn" class="primary-button">+ New Memory Image</button>
                </div>
            </header>
            <div id="memimg-list-content" class="list-content"></div>
        </div>

        <!-- Explorer View (hidden by default) -->
        <div id="explorer-view" class="view-container" style="display: none;">
            <!-- Script History Sidebar -->
            <div id="script-history-sidebar" class="sidebar collapsed">
                <div class="sidebar-header">
                    <h3>Script History</h3>
                    <button id="close-history-btn" class="icon-btn" title="Close history panel">✕</button>
                </div>
                <div class="sidebar-controls">
                    <input type="text" id="history-search" placeholder="Search scripts..." />
                    <button id="export-history-btn" class="icon-btn" title="Export history">📥</button>
                    <button id="clear-history-btn" class="icon-btn" title="Clear history">🗑️</button>
                </div>
                <div class="sidebar-stats">
                    <span class="history-stats"></span>
                </div>
                <div id="history-list" class="sidebar-content"></div>
            </div>

            <!-- Compact Header -->
            <header class="compact-header">
                <div class="header-left">
                    <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"
                    width="28" height="28" aria-label="Navigator">
                        <circle cx="24" cy="24" r="22" fill="#6366f1"/>
                        <line x1="24" y1="14" x2="16" y2="24" stroke="#fbbf24" stroke-width="2" stroke-linecap="round"/>
                        <line x1="24" y1="14" x2="32" y2="24" stroke="#fbbf24" stroke-width="2" stroke-linecap="round"/>
                        <line x1="16" y1="24" x2="24" y2="34" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
                        <line x1="32" y1="24" x2="24" y2="34" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
                        <line x1="16" y1="24" x2="32" y2="24" stroke="#ec4899" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="24" cy="14" r="4" fill="#fef3c7"/>
                        <circle cx="16" cy="24" r="4" fill="#fde68a"/>
                        <circle cx="32" cy="24" r="4" fill="#fde68a"/>
                        <circle cx="24" cy="34" r="4" fill="#fef3c7"/>
                        <circle cx="24" cy="24" r="3" fill="#ffffff"/>
                        <text x="24" y="43" font-family="Arial, sans-serif"
                        font-size="5.5" font-weight="bold" fill="#ffffff"
                        text-anchor="middle" letter-spacing="1.5">Navigator</text>
                    </svg>
                    <span class="app-title-inline">Filer Navigator</span>
                    <span class="title-separator">|</span>
                    <h1 id="current-memimg-name" class="memimg-name-inline">Memory Image</h1>
                </div>
                <div class="header-right">
                    <button id="back-to-list-btn" class="compact-btn" title="Back to list">← Back</button>
                    <button id="save-btn" class="compact-btn" title="Save to IndexedDB">💾 Save</button>
                    <button id="discard-btn" class="compact-btn" title="Discard unsaved changes" style="display: none;">↩️ Discard</button>
                    <button id="export-events-btn" class="compact-btn" title="✅ Export event log (NDJSON format - CAN be re-imported)">📜 Export Events</button>
                    <button id="import-events-btn" class="compact-btn" title="Import event log (NDJSON format only - snapshots cannot be imported)">📥 Import Events</button>
                    <button id="export-snapshot-btn" class="compact-btn" title="⚠️  Export current state as JSON (for external use only - CANNOT be re-imported)">📸 Snapshot</button>
                    <button id="clear-btn" class="compact-btn" title="Clear all data">🗑️ Clear</button>
                    <button id="load-scott-btn" class="compact-btn" title="Load example data">📂 Load Example</button>
                    <button id="theme-toggle-explorer" class="icon-btn compact-btn" title="Toggle theme">☀️</button>
                </div>
            </header>
            <!-- Hidden file input for import -->
            <input type="file" id="events-file-input" accept=".json,.ndjson,.txt" style="display: none">
            <div id="status" class="status-bar"></div>

            <!-- Code editor (TOP panel) -->
            <section id="editor-panel" class="panel">
                <div class="panel-header">
                    <h2>Code Editor</h2>
                    <div class="editor-controls">
                        <button id="maximize-editor-btn" class="icon-btn" title="Maximize editor (Alt+E)">⛶</button>
                        <button id="toggle-line-numbers-btn" class="icon-btn" title="Toggle line numbers">#</button>
                        <button id="toggle-history-btn" title="Show script history">📜 History</button>
                        <button id="run-btn" title="Run code (Ctrl+Enter)">▶ Run</button>
                    </div>
                </div>
                <div class="editor-wrapper">
                    <div class="line-numbers" id="line-numbers"></div>
                    <div id="code-editor" class="code-editor" spellcheck="false"></div>
                </div>
                <div id="error-panel" class="error-panel" style="display: none;"></div>
            </section>

            <!-- Vertical resize handle -->
            <div class="resize-handle resize-handle-horizontal" data-direction="vertical"></div>

            <!-- Bottom panels (Object Graph) -->
            <main id="bottom-panels">
                <!-- Tree view (left panel) -->
                <section id="tree-panel" class="panel">
                    <div class="panel-header">
                        <h2>Object Graph</h2>
                        <div class="nav-buttons">
                            <button id="maximize-graph-btn" class="icon-btn" title="Maximize graph (Alt+G)">⛶</button>
                            <button id="back-btn" title="Back (Alt+Left)" disabled>◀</button>
                            <button id="forward-btn" title="Forward (Alt+Right)" disabled>▶</button>
                        </div>
                    </div>
                    <div id="tree-view" class="panel-content"></div>
                </section>

                <!-- Horizontal resize handle -->
                <div class="resize-handle resize-handle-vertical" data-direction="horizontal"></div>

                <!-- Property inspector (right panel) -->
                <section id="inspector-panel" class="panel">
                    <div class="panel-header">
                        <h2>Properties</h2>
                        <span id="selected-path" class="path-display"></span>
                    </div>
                    <div id="inspector-view" class="panel-content"></div>
                </section>
            </main>
        </div>
    </div>

    <!-- Load main module -->
</body>
</html>
